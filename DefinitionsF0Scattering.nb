(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    221781,       5052]
NotebookOptionsPosition[    218684,       5010]
NotebookOutlinePosition[    219077,       5026]
CellTagsIndexPosition[    219034,       5023]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Requires\n",
  FontWeight->"Bold"],
 "F0Scattering\nMaTeX"
}], "Text",
 CellChangeTimes->{{3.942997739749977*^9, 
  3.942997761554233*^9}},ExpressionUUID->"8aac650e-b037-4d4a-b4f0-\
093479733e41"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<F0Scattering`\>\"", "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<MaTeX`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.94300053197796*^9, 
  3.943000553106196*^9}},ExpressionUUID->"33f15212-f082-40eb-9b84-\
aa303fa37690"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"texStyle", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}], ",", " ", 
     RowBox[{"FontSize", "->", "12"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"MaTeX", ",", " ", 
    RowBox[{"FontSize", "->", "12"}], ",", " ", 
    RowBox[{"\"\<Preamble\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\\\\usepackage{newtxtext,newtxmath}\>\"", ",", " ", 
       "\"\<\\\\usepackage{color} \\\\definecolor{myblue}{RGB}{31,119,180} \\\
\\definecolor{mygreen}{RGB}{44,160,44} \\\\definecolor{myred}{RGB}{214,39,40} \
\\\\definecolor{myorange}{RGB}{255,127,14}\>\""}], "}"}]}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.942997796117684*^9, 3.942997810823785*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9084a06b-8c75-4e64-9bf3-045be167eec1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "TranslateGraphics", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateGraphics", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"directives_List", ",", "opts___"}], "]"}], ",", "vec_List"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"Translate", "[", 
      RowBox[{"directives", ",", "vec"}], "]"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"018dca1b-eba2-4d5f-81a5-a9a69dfe4ea5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "CloseToBoundary", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseToBoundary", "::", "usage"}], " ", "=", " ", 
   "\"\<CloseToBoundary[tau, tol] evaluates true if tau is within tol of the \
boundary of the fundamental domain of \!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(0\)]\)(4)\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseToBoundary", "[", 
    RowBox[{"tau_", ",", " ", "tol_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Re", "[", "tau", "]"}], "<", "tol"}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"Re", "[", "tau", "]"}]}], "<", "tol"}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", "tau", "]"}], "<", "tol"}], ")"}], " ", "||", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Re", "[", "tau", "]"}], ",", " ", "1"}], "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"Im", "[", "tau", "]"}]}], "-", 
        RowBox[{"1", "/", "4"}]}], "]"}], "-", 
      RowBox[{"1", "/", "4"}]}], "<", "tol"}], "||", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Re", "[", "tau", "]"}], ",", " ", "1"}], "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"Im", "[", "tau", "]"}]}], "-", 
        RowBox[{"3", "/", "4"}]}], "]"}], "-", 
      RowBox[{"1", "/", "4"}]}], "<", "tol"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseToBoundary", "[", 
    RowBox[{"tau_", ",", " ", "tol_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Im", "[", "tau", "]"}], "<", "tol"}], ")"}], " ", "||", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Re", "[", "tau", "]"}], ",", " ", "1"}], "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"Im", "[", "tau", "]"}]}], "-", 
        RowBox[{"1", "/", "4"}]}], "]"}], "-", 
      RowBox[{"1", "/", "4"}]}], "<", "tol"}], "||", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Re", "[", "tau", "]"}], ",", " ", "1"}], "]"}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"Im", "[", "tau", "]"}]}], "-", 
        RowBox[{"3", "/", "4"}]}], "]"}], "-", 
      RowBox[{"1", "/", "4"}]}], "<", "tol"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.925638596273238*^9, 3.925638697278302*^9}, {
   3.925639262709781*^9, 3.925639295583637*^9}, {3.925639808918231*^9, 
   3.925639809734395*^9}, {3.9257893434091587`*^9, 3.925789430446925*^9}, 
   3.926060951757343*^9, {3.926232038795431*^9, 3.926232101598159*^9}, {
   3.926232134977252*^9, 3.9262321382776623`*^9}, {3.926487282092025*^9, 
   3.926487294086749*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"f3101aed-2cca-4c30-ae9d-94613ad262d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "BetterBackground", ",", " ", "$gamlist", ",", " ", 
    "$gamlistWithThickness"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BetterBackground", "::", "usage"}], " ", "=", " ", 
   "\"\<BetterBackground[m, xrange] produces a plot of the branch points, \
branch cuts and domains of Gamma_0(4) in the tau plane\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BetterBackground", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<ConvRegion\>\"", "->", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\"\<AddObj\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<BranchPoints\>\"", ",", " ", "\"\<BranchCuts\>\"", ",", " ", 
        "\"\<Cusps\>\""}], "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BetterBackground", "[", 
    RowBox[{"m_", ",", " ", 
     RowBox[{"xRange_", ":", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "1"}], "}"}]}], ",", " ", 
     RowBox[{"kRange_", ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", " ", "5"}], "}"}]}], ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"BetterBackground", "[", 
     RowBox[{"m", ",", " ", "xRange", ",", " ", "kRange"}], "]"}], " ", "=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "taub", ",", " ", "xRangeProper", ",", " ", "tau", ",", " ", 
        "gam14Ops", ",", "\[IndentingNewLine]", "branchPoints", ",", " ", 
        "translate", ",", " ", "translateGraphics", ",", " ", "branchCuts", 
        ",", " ", "cusps", ",", " ", "large", ",", " ", "conv"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"taub", " ", "=", " ", 
        RowBox[{"tauB", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"--", " ", "Uncomment"}], " ", "for", " ", "Figure", " ", 
          RowBox[{"12", " ", "--"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gam14Ops", " ", "=", " ", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pMax", " ", "=", " ", "4"}], "}"}], ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "!=", "0"}], "&&", 
                   RowBox[{"IntegerQ", "[", 
                    FractionBox[
                    RowBox[{"1", "+", 
                    RowBox[{"b", " ", "c"}]}], "a"], "]"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", ",", " ", "b"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", " ", 
                    FractionBox[
                    RowBox[{"1", "+", 
                    RowBox[{"b", " ", "c"}]}], "a"]}], "}"}]}], "}"}], ",", 
                  " ", "Nothing"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"a", ",", " ", 
                  RowBox[{
                   RowBox[{"-", "4"}], "pMax"}], ",", " ", 
                  RowBox[{"4", "pMax"}], ",", " ", "1"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"b", ",", " ", 
                  RowBox[{
                   RowBox[{"-", "4"}], "pMax"}], ",", " ", 
                  RowBox[{"4", "pMax"}], ",", " ", "1"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{
                   RowBox[{"-", "4"}], "pMax"}], ",", " ", 
                  RowBox[{"4", "pMax"}], ",", " ", "4"}], "}"}]}], "]"}], ",",
               " ", "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gam14Ops", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], "tau"}], " ", 
                 "+", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "tau"}], "+", 
                 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", " ", "2"}], "]"}], "]"}]}], ")"}]}], 
              "&"}], "/@", "gam14Ops"}], ",", " ", 
            RowBox[{
             RowBox[{"0", "<=", 
              RowBox[{"Re", "[", 
               RowBox[{"#", "/.", 
                RowBox[{"{", 
                 RowBox[{"tau", "->", 
                  RowBox[{".2", "+", 
                   RowBox[{".2", "I"}]}]}], "}"}]}], "]"}], "<=", "1"}], 
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gam14Ops", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"gam14Ops", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"#", "/.", 
                RowBox[{"{", 
                 RowBox[{"tau", "->", 
                  RowBox[{".5", "+", 
                   RowBox[{".6", "I"}]}]}], "}"}]}], "]"}], ">", ".01"}], 
             "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"--", " ", "Comment"}], " ", "out", " ", "for", " ", 
         "Figure", " ", 
         RowBox[{"12", " ", "--"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"gam14Ops", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", "k"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", "k"}]}], ")"}], " ", "tau"}]}], 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "k"}], "+", 
            RowBox[{"4", " ", "k", " ", "tau"}]}]], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", 
            RowBox[{"First", "@", "kRange"}], ",", " ", 
            RowBox[{"Last", "@", "kRange"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"$gamlist", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{"gam14Ops", "/.", 
          RowBox[{"{", 
           RowBox[{"tau", "->", 
            RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}]}], "}"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"$gamlistWithThickness", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"Pi", " ", 
                RowBox[{"#", "/", "2"}]}], "]"}], "&"}], "@", 
             RowBox[{"Rescale", "[", 
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"#", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}], "->", 
                   RowBox[{".6", "+", 
                    RowBox[{".5", "I"}]}]}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", ".5"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "1"}], "}"}]}], "]"}]}]}], "}"}], 
          "&"}], "/@", "$gamlist"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Translating", ",", " ", "Copying"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"xRangeProper", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{"First", "@", "xRange"}], "]"}], ",", " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"Last", "@", "xRange"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"translate", "[", "g_", "]"}], " ", ":=", " ", 
        RowBox[{"Translate", "[", 
         RowBox[{"g", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", " ", "0"}], "}"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"First", "@", "xRange"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{"Last", "@", "xRange"}], "]"}], "-", "1"}]}], 
            "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"translateGraphics", "[", "g_", "]"}], " ", ":=", " ", 
        RowBox[{"TranslateGraphics", "[", 
         RowBox[{"g", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", " ", "0"}], "}"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"First", "@", "xRange"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{"Last", "@", "xRange"}], "]"}], "-", "1"}]}], 
            "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Gamma_", "0", 
         RowBox[{"(", "4", ")"}], " ", "Domains"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cusps", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"I", " ", "large"}], ",", " ", "0", ",", " ", 
          RowBox[{"1", "/", "2"}], ",", " ", "1"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cusps", " ", "=", " ", 
        RowBox[{"Limit", "[", 
         RowBox[{
          RowBox[{"gam14Ops", "/.", 
           RowBox[{"{", 
            RowBox[{"tau", "->", "cusps"}], "}"}]}], ",", " ", 
          RowBox[{"large", "->", "\[Infinity]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cusps", " ", "=", " ", 
        RowBox[{"translate", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", " ", 
             RowBox[{"Thickness", "[", ".001", "]"}]}], "]"}], ",", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"UHPGeodesic", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"UHPGeodesic", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"UHPGeodesic", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"UHPGeodesic", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
                 RowBox[{"t", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "cusps"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Branch", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"branchPoints", " ", "=", 
        RowBox[{"translate", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"PointSize", "[", ".01", "]"}], ",", " ", "Red"}], "]"}],
            ",", " ", 
           RowBox[{"Point", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ReIm", "@", "#"}], "/.", 
               RowBox[{"{", 
                RowBox[{"tau", "->", "taub"}], "}"}]}], "&"}], "/@", 
             "gam14Ops"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Branch", " ", "cuts"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"branchCuts", " ", "=", " ", 
        RowBox[{"translate", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", " ", "Dashed", ",", " ", 
             RowBox[{"Thickness", "[", ".002", "]"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"UHPGeodesic", "[", 
              RowBox[{
               RowBox[{"#", "/.", 
                RowBox[{"tau", "->", "taub"}]}], ",", 
               RowBox[{"#", "/.", 
                RowBox[{"tau", "->", 
                 RowBox[{"1", "/", "2"}]}]}]}], "]"}], "&"}], "/@", 
            "gam14Ops"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"convergence", " ", "domain"}], ",", " ", 
         RowBox[{"tau", " ", "=", " ", 
          RowBox[{"I", " ", "inf"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conv", "[", "\"\<LV\>\"", "]"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ConvRegion\>\"", "]"}], ",", 
            " ", "\"\<LV\>\""}], "]"}], ",", " ", 
          RowBox[{"translateGraphics", "@", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", " ", "=", " ", "Orange"}], "}"}], ",", " ", 
             RowBox[{"RegionPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{"(", 
                  RowBox[{"t1", "+", 
                   RowBox[{"I", " ", "t2"}]}], ")"}], "]"}], ">", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Im", "[", "taub", "]"}], ",", " ", 
                  RowBox[{"Im", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"taub", "-", "1"}], ")"}]}], "]"}]}], "]"}]}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"t1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Opacity", "[", ".2", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BoundaryStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", " ", "Nothing"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"convergence", " ", "domain"}], ",", " ", 
         RowBox[{"tau", " ", "=", " ", "0"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conv", "[", "\"\<p\>\"", "]"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ConvRegion\>\"", "]"}], ",", 
            " ", "\"\<p\>\""}], "]"}], ",", " ", 
          RowBox[{"translateGraphics", "@", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", " ", "=", " ", "Blue"}], "}"}], ",", " ", 
             RowBox[{"RegionPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "4"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"t1", "+", 
                    RowBox[{"I", " ", "t2"}]}], ")"}]}], "]"}], ">", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Im", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], "/", "taub"}], "]"}], ",",
                   " ", 
                  RowBox[{"Im", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"taub", "-", "1"}], ")"}]}], "]"}]}], "]"}]}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"t1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Opacity", "[", ".2", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BoundaryStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", " ", "Nothing"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"convergence", " ", "domain"}], ",", " ", 
         RowBox[{"tau", " ", "=", " ", 
          RowBox[{"1", "/", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conv", "[", "\"\<pp\>\"", "]"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ConvRegion\>\"", "]"}], ",", 
            " ", "\"\<pp\>\""}], "]"}], ",", " ", 
          RowBox[{"translateGraphics", "@", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", " ", "=", " ", 
               RowBox[{"Darker", "[", "Green", "]"}]}], "}"}], ",", " ", 
             RowBox[{"RegionPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 FractionBox[
                  RowBox[{"t1", "+", 
                   RowBox[{"I", " ", "t2"}]}], 
                  RowBox[{"1", "-", 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"t1", "+", 
                    RowBox[{"I", " ", "t2"}]}], ")"}]}]}]], "]"}], ">", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Im", "[", 
                   FractionBox["taub", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "taub"}]}]], "]"}], ",", " ", 
                  RowBox[{"Im", "[", 
                   FractionBox[
                    RowBox[{"taub", "-", "1"}], 
                    RowBox[{"3", "-", 
                    RowBox[{"2", "taub"}]}]], "]"}]}], "]"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Opacity", "[", ".2", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BoundaryStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", " ", "Nothing"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"convergence", " ", "domain"}], ",", " ", 
         RowBox[{"tau", " ", "=", " ", "1"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conv", "[", "\"\<ppp\>\"", "]"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ConvRegion\>\"", "]"}], ",", 
            " ", "\"\<ppp\>\""}], "]"}], ",", " ", 
          RowBox[{"translateGraphics", "@", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", " ", "=", " ", "Blue"}], "}"}], ",", " ", 
             RowBox[{"RegionPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "4"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"t1", "+", 
                    RowBox[{"I", " ", "t2"}], "-", "1"}], ")"}]}], "]"}], ">", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Im", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], "/", "taub"}], "]"}], ",",
                   " ", 
                  RowBox[{"Im", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"taub", "-", "1"}], ")"}]}], "]"}]}], "]"}]}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"t1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Opacity", "[", ".2", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BoundaryStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", " ", "Nothing"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"convergence", " ", "domain"}], ",", " ", 
         RowBox[{"tau", " ", "=", " ", "tau_B"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conv", "[", "\"\<B\>\"", "]"}], " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ConvRegion\>\"", "]"}], ",", 
            " ", "\"\<B\>\""}], "]"}], ",", " ", 
          RowBox[{"translateGraphics", "@", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", " ", "=", " ", "Magenta"}], "}"}], ",", " ", 
             RowBox[{"RegionPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"ztau", "[", 
                  RowBox[{
                   RowBox[{"t1", "+", 
                    RowBox[{"I", " ", "t2"}]}], ",", " ", "m"}], "]"}], "]"}],
                 ">", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", "Pi", " ", "m"}], "]"}]}], ")"}]}], 
                   "]"}], "^", "2"}], "/", "4"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t1", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"t2", ",", " ", "0.006", ",", " ", "1"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Opacity", "[", ".2", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BoundaryStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{"c", ",", " ", 
                  RowBox[{"Thickness", "[", ".003", "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotPoints", "->", "150"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"MaxRecursion", "->", "3"}]}], "\[IndentingNewLine]", 
              "]"}]}], "]"}]}], ",", " ", "Nothing"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Infinity", ",", " ", "Infinity"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"s", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "->", "None"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{"xRange", ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "->", "texStyle"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"MaTeX", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\\\\Re \\\\tau\>\"", ",", " ", 
                 "\"\<\\\\Im \\\\tau\>\""}], "}"}], ",", 
               RowBox[{"ContentPadding", "\[Rule]", "False"}]}], "]"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"FrameStyle", "->", "BlackFrame"}], 
            RowBox[{"(*", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"GridLines", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"Sequence", "@@", "xRangeProper"}], "]"}], ",", " ",
                  "None"}], "}"}]}], ","}], "*)"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Axes", "->", "False"}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<AddObj\>\"", "]"}], ",", " ", 
              "\"\<BranchPoints\>\""}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", "branchPoints", "]"}], ",", " ", 
            "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<AddObj\>\"", "]"}], ",", " ", 
              "\"\<BranchCuts\>\""}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", "branchCuts", "]"}], ",", " ", 
            "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<AddObj\>\"", "]"}], ",", " ", 
              "\"\<Cusps\>\""}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", "cusps", "]"}], ",", " ", "Nothing"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"conv", "[", "\"\<LV\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"conv", "[", "\"\<p\>\"", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"conv", "[", "\"\<pp\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"conv", "[", "\"\<ppp\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"conv", "[", "\"\<B\>\"", "]"}]}], "\[IndentingNewLine]", 
         "}"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BetterBackground", "[", 
   RowBox[{".5", ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "1"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.929598972374974*^9, 3.929598978197916*^9}, {
   3.92959900991229*^9, 3.929599177499283*^9}, {3.931163813125841*^9, 
   3.931163824981281*^9}, {3.931164658559379*^9, 3.931164661468963*^9}, {
   3.931165165758124*^9, 3.93116517292045*^9}, {3.931165204995901*^9, 
   3.931165217409923*^9}, {3.93116525985958*^9, 3.931165336224273*^9}, 
   3.931165793910674*^9, {3.931503327348432*^9, 3.9315033274907722`*^9}, {
   3.931590506052089*^9, 3.931590509294138*^9}, {3.9325447935596457`*^9, 
   3.932544799713662*^9}, {3.932544834333948*^9, 3.932544835463984*^9}, {
   3.932544867658169*^9, 3.932544867919973*^9}, {3.932546185954596*^9, 
   3.932546192248951*^9}, {3.932550486331485*^9, 3.932550489466968*^9}, {
   3.9325513222061234`*^9, 3.9325513223830833`*^9}, {3.932551354945162*^9, 
   3.932551355125803*^9}, {3.932713300476019*^9, 3.93271330383974*^9}, {
   3.933086761140904*^9, 3.9330867643200912`*^9}, {3.933087525495616*^9, 
   3.933087526375923*^9}, {3.9332505843436823`*^9, 3.933250587804943*^9}, {
   3.933753924842227*^9, 3.933753977939569*^9}, {3.933754874219236*^9, 
   3.93375490010294*^9}, {3.933754985469254*^9, 3.933754993030837*^9}, {
   3.9337599888181133`*^9, 3.933759992095632*^9}, {3.933760137940783*^9, 
   3.9337601425338182`*^9}, {3.933760934059785*^9, 3.933760936860908*^9}, {
   3.93376789237074*^9, 3.933767896339776*^9}, 3.9337682313409986`*^9, {
   3.933832895348774*^9, 3.9338328986575413`*^9}, {3.933868850261351*^9, 
   3.93386886890919*^9}, {3.9338696067950287`*^9, 3.9338696099979677`*^9}, {
   3.934442558838526*^9, 3.934442574369948*^9}, {3.9344426183645487`*^9, 
   3.934442618946113*^9}, {3.934443478634551*^9, 3.9344434810991707`*^9}, {
   3.934452928992096*^9, 3.9344529463641033`*^9}, {3.93445502386919*^9, 
   3.934455024074813*^9}, {3.9344556623379498`*^9, 3.934455665961759*^9}, {
   3.934455699756674*^9, 3.9344557637217007`*^9}, {3.934455994985504*^9, 
   3.93445604373007*^9}, {3.934456079814702*^9, 3.9344560827741137`*^9}, {
   3.934456736705937*^9, 3.934456745169827*^9}, {3.9344586419020653`*^9, 
   3.9344586497307463`*^9}, {3.934530644901724*^9, 3.934530659564679*^9}, {
   3.934530744688841*^9, 3.934530758711741*^9}, {3.935058306524708*^9, 
   3.935058327764799*^9}, {3.936253777021963*^9, 3.9362537877588167`*^9}, {
   3.936532066474683*^9, 3.936532100817754*^9}, {3.937044023187202*^9, 
   3.9370440248989563`*^9}, {3.937045536398006*^9, 3.9370456018758497`*^9}, {
   3.9370456898729258`*^9, 3.9370456922305202`*^9}, {3.93712138642546*^9, 
   3.937121387674961*^9}, {3.937295649576549*^9, 3.9372956521549473`*^9}, {
   3.9375527501029577`*^9, 3.937552751268321*^9}, 3.938149928312375*^9, {
   3.938166089841947*^9, 3.9381660906411343`*^9}, {3.9382450722965527`*^9, 
   3.938245075219287*^9}, {3.9399994158221416`*^9, 3.93999941711589*^9}, {
   3.941098861568668*^9, 3.9410988644891253`*^9}, {3.941098921083748*^9, 
   3.941098929261627*^9}, {3.9410992918511133`*^9, 3.941099330387889*^9}, {
   3.941099386239209*^9, 3.941099412699617*^9}, {3.941196349937854*^9, 
   3.941196350011223*^9}, {3.942730542323892*^9, 3.942730561273744*^9}, {
   3.9427307485400267`*^9, 3.942730768156287*^9}, {3.9427309443189096`*^9, 
   3.94273094539991*^9}, {3.9429057861823874`*^9, 3.942905845965399*^9}, {
   3.942911664101261*^9, 3.94291167115536*^9}, {3.942911739587102*^9, 
   3.9429117397608023`*^9}, {3.942911829007655*^9, 3.942911832078558*^9}, 
   3.942911940081286*^9, {3.942911975667553*^9, 3.942912016827723*^9}, {
   3.942912068840173*^9, 3.942912082268708*^9}, {3.942912136576915*^9, 
   3.9429121366779633`*^9}, {3.9429122646234703`*^9, 
   3.9429123048185587`*^9}, {3.942912376192518*^9, 3.942912425241053*^9}, {
   3.9430002966577883`*^9, 3.94300030587353*^9}, {3.943000844592382*^9, 
   3.9430008653218527`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"a83a0b6e-71f4-454e-b594-8e698d044fe6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "J4D", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J4D", "[", "tau_", "]"}], " ", ":=", " ", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", "Pi", " ", "I", " ", 
      SuperscriptBox[
       RowBox[{"DedekindEta", "[", 
        RowBox[{"2", "tau"}], "]"}], "20"]}], 
     SuperscriptBox[
      RowBox[{"DedekindEta", "[", 
       RowBox[{"4", " ", "tau"}], "]"}], "16"]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.942997997246345*^9, 3.94299799965302*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"e4f3a887-91cd-4115-8f5a-0ab45dabf141"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RayProperAIm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RayProperAIm", "[", 
    RowBox[{"gam_", ",", " ", "m_", ",", " ", 
     RowBox[{"n_", ":", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"RayProperAIm", "[", 
     RowBox[{"gam", ",", " ", "m", ",", " ", "n"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eps", " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}]}], ",", 
        RowBox[{"taup2Start", " ", "=", " ", "4"}], ",", " ", 
        RowBox[{"$maxtaup2", " ", "=", " ", "200"}], ",", " ", "taupStart", 
        ",", " ", "eqns", ",", " ", "soln", ",", " ", "corr", ",", " ", 
        "Fricke", ",", " ", "FrickeInv", ",", " ", "r", ",", " ", "d1", ",", 
        " ", "d2", ",", " ", "ch2", ",", " ", "taup", ",", " ", "Om", ",", 
        " ", "t", ",", " ", "b1", ",", " ", "b2", ",", " ", "tauFinal", ",", 
        " ", "taub", ",", " ", "T0"}], "}"}], ",", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "d1", ",", " ", "d2", ",", " ", "ch2"}], 
          "}"}], " ", "=", " ", "gam"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b1", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{"b2", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"taub", " ", "=", " ", 
         RowBox[{"$gamlist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}], "->", 
            RowBox[{"tauB", "[", "m", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fricke", "[", "tau_", "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", "*", "tau"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"FrickeInv", " ", "=", " ", "Fricke"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"taupStart", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "Pi"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"Pi", " ", "-", " ", 
             RowBox[{"Arg", "[", 
              FractionBox[
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}], "2"]], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}]]}], 
                ")"}]], "]"}]}], ")"}]}], " ", "-", " ", 
          RowBox[{"n", "/", "2"}], " ", "+", " ", 
          RowBox[{"taup2Start", " ", "I"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"taupStart", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"corr", " ", "+", " ", "taupStart"}], ")"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Im", "[", 
             RowBox[{"EichlerZ", "[", 
              RowBox[{"gam", ",", " ", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"corr", " ", "+", " ", "taupStart"}], "]"}], ",", " ",
                "m"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"corr", ",", " ", "0", ",", " ", 
              RowBox[{"-", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]}]}], ",", " ", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}]}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"taup", "'"}], "[", "t", "]"}], " ", "==", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "<", "0"}], ",", " ", 
              "0", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}], " ", "I", "*", "4", 
               "*", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "2"}], "*", 
               RowBox[{"Normalize", "[", 
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "r"}], "+", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}], 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "4"}], "*", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "6"}], "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "4"}]}]}], 
                  "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"Om", "[", "t", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"taup", "[", "0", "]"}], " ", "==", " ", "taupStart"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ModularJ4", "[", 
                 RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}], 
              RowBox[{"Om", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "'"}], "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}], ")"}], 
                 RowBox[{
                  RowBox[{"Om", "[", "t", "]"}], "^", "2"}]}], "-", "2"}], 
               ")"}], 
              RowBox[{"J4D", "[", 
               RowBox[{"taup", "[", "t", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"taup", "'"}], "[", "t", "]"}]}]}], "==", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Om", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ModularJ4", "[", "taupStart", "]"}], "+", "8"}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ModularJ4", "[", "taupStart", "]"}], "+", "24", "+", 
                
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", "taupStart", "]"}], "-", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "taupp", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Arg", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}]}], 
                 RowBox[{"EichlerZ", "[", 
                  RowBox[{"gam", ",", " ", 
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                  "]"}]}], "]"}], "]"}], ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b1", "=", 
                RowBox[{"b1", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"taup", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"taup", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{"I", " ", 
                  RowBox[{
                   RowBox[{"Im", "[", 
                    RowBox[{"EichlerZ", "[", 
                    RowBox[{"gam", ",", " ", 
                    RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                    "]"}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"8", "I", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "r"}], "+", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}], 
                    RowBox[{"taup", "[", "t", "]"}]}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "4"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "6"}], "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "4"}]}], "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}]}], "}"}]}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "Om", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], "]"}], 
              ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b2", "=", 
                RowBox[{"b2", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"Om", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"EichlerZ", "[", 
                RowBox[{"gam", ",", " ", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "20"}], ")"}]}]}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "]"}], "<", "eps"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "]"}], ">", "1"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "#"}], "]"}],
                  "&"}], "/@", "taub"}], "]"}], "<", "eps"}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"NDSolve", "[", 
            RowBox[{"eqns", ",", " ", 
             RowBox[{"{", 
              RowBox[{"taup", ",", " ", "Om"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"StepMonitor", ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sMonitor", " ", "=", " ", "t"}], ";", " ", 
                RowBox[{"tauMonitor", "=", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taup", "[", "t", "]"}], "]"}]}], ";", " ", 
                RowBox[{"OmMonitor", "=", 
                 RowBox[{"Om", "[", "t", "]"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MaxStepSize", "->", "0.001"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "sMonitor", ",", " ", "tauMonitor", ",", " ", "OmMonitor"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$Debug", "||", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "b1", ",", " ", "\"\< bumps in taupp, \>\"", ",", " ", "b2", ",", 
             " ", "\"\< bumps in Om\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"T0", " ", "=", " ", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"8", " ", 
            RowBox[{"Re", "[", "taupStart", "]"}]}]], 
          RowBox[{"(", 
           RowBox[{"\[Pi]", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Ceiling", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"Arg", "[", 
                    FractionBox["taupStart", 
                    RowBox[{"Re", "[", "taupStart", "]"}]], "]"}]}]}], 
                    RowBox[{"2", " ", "\[Pi]"}]], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"Re", "[", "taupStart", "]"}], "<", "0"}]}], 
                  "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"Arg", "[", 
                    FractionBox["taupStart", 
                    RowBox[{"Re", "[", "taupStart", "]"}]], "]"}]}]}], 
                    RowBox[{"2", " ", "\[Pi]"}]], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"Re", "[", "taupStart", "]"}], ">", "0"}]}], 
                  "}"}]}], "}"}], ",", " ", "0"}], "]"}], " ", "\[Pi]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Arg", "[", 
              FractionBox["taupStart", 
               RowBox[{"Re", "[", "taupStart", "]"}]], "]"}]}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"taupStart", ",", " ", "T0"}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauFinal", "[", "t_", "]"}], " ", ":=", " ", 
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "taupStart", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Re", "[", "taupStart", "]"}], " ", 
                   RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", "t", " ", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "+", 
                    RowBox[{"Arg", "[", 
                    RowBox[{"taupStart", "/", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "]"}]}], 
                    "]"}]}]}], ")"}]}], " ", "+", " ", "taupStart"}], ",", 
              " ", 
              RowBox[{"t", "<", "0"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"taup", "[", "t", "]"}], "/.", 
               RowBox[{"First", "@", "soln"}]}], ",", " ", 
              RowBox[{"t", ">=", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FrickeInv", "[", 
            RowBox[{"tauFinal", "[", "#", "]"}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"T0", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"taup", "/.", 
                RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
              "\"\<Domain\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932713362850424*^9, 3.93271365616076*^9}, {
   3.932713713814685*^9, 3.932713786571229*^9}, 3.9327139000197067`*^9, {
   3.932714025525086*^9, 3.9327140347469273`*^9}, {3.9327141673930187`*^9, 
   3.9327142082190037`*^9}, {3.932714523451254*^9, 3.932714551354928*^9}, {
   3.9327146074523783`*^9, 3.932714616092286*^9}, {3.932714664730444*^9, 
   3.932714700878821*^9}, {3.932715259815342*^9, 3.9327152636361*^9}, {
   3.932715573071046*^9, 3.932715614870385*^9}, {3.93271569251307*^9, 
   3.9327157215247087`*^9}, {3.932791855459231*^9, 3.932791899971588*^9}, {
   3.932791957685053*^9, 3.9327920971133623`*^9}, {3.932792234325576*^9, 
   3.932792262100027*^9}, {3.932793847138021*^9, 3.932793857282599*^9}, {
   3.932793925832597*^9, 3.9327939259597397`*^9}, {3.932794017473398*^9, 
   3.932794017825692*^9}, {3.932794092149885*^9, 3.932794105321526*^9}, {
   3.932794328544186*^9, 3.932794347688314*^9}, {3.932794642982032*^9, 
   3.932794644906739*^9}, {3.9327948158904963`*^9, 3.932794818136239*^9}, {
   3.9327957024759493`*^9, 3.932795715345366*^9}, {3.932798801470724*^9, 
   3.9327988122362127`*^9}, {3.9327988522374973`*^9, 3.932798863882535*^9}, {
   3.932798895517037*^9, 3.932798895803554*^9}, {3.932799023331348*^9, 
   3.9327990241903954`*^9}, {3.932810609494754*^9, 3.932810617650084*^9}, {
   3.932810667219152*^9, 3.93281070351103*^9}, {3.932810789618804*^9, 
   3.932810937070546*^9}, {3.932811144991497*^9, 3.9328111498920593`*^9}, {
   3.9328122464771643`*^9, 3.932812251189698*^9}, {3.9328226179321632`*^9, 
   3.932822622680921*^9}, {3.932882256283701*^9, 3.932882271832445*^9}, {
   3.932882827763298*^9, 3.93288285494998*^9}, 3.9328841094046593`*^9, {
   3.9329635581090393`*^9, 3.932963559032154*^9}, {3.932963625657847*^9, 
   3.9329636299077187`*^9}, {3.932963998420763*^9, 3.93296403075091*^9}, {
   3.932964118619417*^9, 3.9329641193270407`*^9}, {3.932964818631405*^9, 
   3.9329648731134977`*^9}, {3.932964904964711*^9, 3.932964922555772*^9}, {
   3.932977272143495*^9, 3.9329772722926073`*^9}, {3.932977655557644*^9, 
   3.932977667057036*^9}, {3.93297771405564*^9, 3.93297772980873*^9}, {
   3.932977789359194*^9, 3.932977791050273*^9}, {3.932977821610177*^9, 
   3.932977928676298*^9}, 3.932978025720131*^9, {3.933059634623599*^9, 
   3.933059636881735*^9}, {3.933059704314724*^9, 3.933059704450354*^9}, {
   3.933059770066778*^9, 3.933059771887534*^9}, {3.933063090436913*^9, 
   3.933063094290524*^9}, {3.9330631541302147`*^9, 3.933063170223859*^9}, {
   3.933063241052142*^9, 3.933063249927589*^9}, 3.93306344993137*^9, 
   3.9330636720485983`*^9, {3.9330638710119457`*^9, 3.933063872587737*^9}, {
   3.933066376894758*^9, 3.933066379360834*^9}, {3.93306644330031*^9, 
   3.933066445725418*^9}, {3.9330665030560913`*^9, 3.933066536434999*^9}, {
   3.933066568690029*^9, 3.933066568842873*^9}, {3.933066728739686*^9, 
   3.9330667294938097`*^9}, {3.9330694957454977`*^9, 3.933069497938573*^9}, {
   3.933069767249969*^9, 3.933069769335197*^9}, {3.933069899737638*^9, 
   3.933069901956675*^9}, {3.9330699546475143`*^9, 3.9330699552564373`*^9}, {
   3.933070023316614*^9, 3.9330700516120043`*^9}, {3.933138343794529*^9, 
   3.933138362975268*^9}, {3.933493141510747*^9, 3.933493190897071*^9}, {
   3.933493623407755*^9, 3.933493653313841*^9}, {3.933493684158092*^9, 
   3.933493686385169*^9}, {3.933493737802101*^9, 3.9334937756348057`*^9}, {
   3.9334938137874193`*^9, 3.9334938168125277`*^9}, {3.9336652085542927`*^9, 
   3.933665260834981*^9}, {3.933665527920453*^9, 3.9336655320905533`*^9}, {
   3.933665584699421*^9, 3.933665589632558*^9}, {3.933665746496624*^9, 
   3.9336657465855427`*^9}, 3.933665794965383*^9, {3.9336659822619553`*^9, 
   3.9336659983986883`*^9}, {3.933666192899981*^9, 3.933666232822075*^9}, {
   3.9336670365342417`*^9, 3.933667036604164*^9}, {3.933667086082601*^9, 
   3.933667105854434*^9}, {3.933667176995298*^9, 3.93366718472071*^9}, {
   3.933667225736125*^9, 3.933667234296444*^9}, {3.933667293397189*^9, 
   3.933667325855666*^9}, {3.9336674051031227`*^9, 3.933667429724337*^9}, {
   3.9336674883062773`*^9, 3.933667503140896*^9}, {3.933667534846253*^9, 
   3.9336675723098497`*^9}, {3.933667772661641*^9, 3.93366781606597*^9}, {
   3.93366786011051*^9, 3.933667880119355*^9}, {3.9336683193241177`*^9, 
   3.933668325398987*^9}, {3.933668361997951*^9, 3.93366839864473*^9}, {
   3.933668839401518*^9, 3.93366884245477*^9}, {3.9336717551342154`*^9, 
   3.9336718599108543`*^9}, {3.933671986986115*^9, 3.933672004798912*^9}, {
   3.933672035313397*^9, 3.933672067300548*^9}, {3.93367292365493*^9, 
   3.933673030840526*^9}, {3.933673090482471*^9, 3.93367312776889*^9}, {
   3.933673165461659*^9, 3.9336731662838173`*^9}, {3.933673199948845*^9, 
   3.933673206644888*^9}, {3.9336773208475246`*^9, 3.9336773209611883`*^9}, 
   3.933755258745041*^9, {3.9337559055369377`*^9, 3.933755907161977*^9}, {
   3.933755948667671*^9, 3.933755949202366*^9}, {3.933756178698022*^9, 
   3.933756179375443*^9}, {3.9337562485264797`*^9, 3.933756248618555*^9}, {
   3.933756382594378*^9, 3.933756396628284*^9}, {3.9337566934451714`*^9, 
   3.933756703767231*^9}, 3.93375735790252*^9, {3.93375744818052*^9, 
   3.933757474947946*^9}, {3.933757512840372*^9, 3.933757709580661*^9}, {
   3.933757897895005*^9, 3.9337579258707952`*^9}, {3.933757984470583*^9, 
   3.933757987631824*^9}, {3.93376067040038*^9, 3.933760687552709*^9}, {
   3.9337608003289433`*^9, 3.933760815912559*^9}, 3.93376784253043*^9, {
   3.9338217903410063`*^9, 3.93382179141844*^9}, {3.933950349765417*^9, 
   3.933950354213316*^9}, {3.934274648935137*^9, 3.934274651183169*^9}, {
   3.9342746982023287`*^9, 3.93427470935211*^9}, 3.934447349541891*^9, {
   3.934526414415215*^9, 3.9345264181063347`*^9}, {3.9345312098195477`*^9, 
   3.934531210230564*^9}, {3.9345320540448217`*^9, 3.934532058509087*^9}, {
   3.934532255052648*^9, 3.934532290617189*^9}, 3.934532561996172*^9, {
   3.934532644274014*^9, 3.9345326687004557`*^9}, 3.934532771101162*^9, 
   3.934532862722847*^9, 3.934532988302536*^9, {3.934533021610928*^9, 
   3.934533043342924*^9}, {3.934533085377294*^9, 3.934533085511179*^9}, {
   3.934533528829247*^9, 3.934533533416153*^9}, 3.934534229559778*^9, {
   3.93564560535921*^9, 3.935645650278406*^9}, {3.935645903954013*^9, 
   3.935645906202964*^9}, {3.935645953297159*^9, 3.935645980590398*^9}, {
   3.9356460490621357`*^9, 3.9356460497953033`*^9}, {3.936071410098996*^9, 
   3.936071457027878*^9}, 3.93652952231034*^9, {3.936549677705559*^9, 
   3.9365496876213417`*^9}, {3.937120950684512*^9, 3.937120950933942*^9}, {
   3.940491626852219*^9, 3.94049167297154*^9}, {3.940491991917*^9, 
   3.940491993501473*^9}, {3.940500931737652*^9, 3.940501003358121*^9}, {
   3.940501183714388*^9, 3.94050120846978*^9}, 3.940501258318331*^9, {
   3.940569487838421*^9, 3.9405695009776697`*^9}, {3.94057160758902*^9, 
   3.940571676301794*^9}, 3.940571718206452*^9, {3.940571752866459*^9, 
   3.940571771726803*^9}, 3.940571810756712*^9, {3.9405718590456533`*^9, 
   3.940571862384883*^9}, {3.940571900109255*^9, 3.9405719024121323`*^9}, {
   3.940571978630122*^9, 3.940571979396858*^9}, {3.940572039318386*^9, 
   3.940572078913143*^9}, {3.940572311806354*^9, 3.940572330721292*^9}, {
   3.940572423903762*^9, 3.940572424991119*^9}, {3.94058599031835*^9, 
   3.940586001157022*^9}, 3.940586215961924*^9, {3.9417778987238083`*^9, 
   3.941777903905375*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"bbab3940-d52e-479f-bdf0-d3812c03a782"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RayProperBIm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RayProperBIm", "[", 
    RowBox[{"gam_", ",", " ", "m_", ",", "  ", 
     RowBox[{"n_", ":", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"RayProperBIm", "[", 
     RowBox[{"gam", ",", " ", "m", ",", " ", "n"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eps", " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}]}], ",", 
        RowBox[{"taupp2Start", " ", "=", " ", "4"}], ",", " ", 
        RowBox[{"$maxtaupp2", " ", "=", " ", "200"}], ",", " ", "tauppStart", 
        ",", " ", "eqns", ",", " ", "soln", ",", " ", "corr", ",", " ", 
        "Fricke", ",", " ", "FrickeInv", ",", " ", "r", ",", " ", "d1", ",", 
        " ", "d2", ",", " ", "ch2", ",", " ", "taupp", ",", " ", "Om", ",", 
        " ", "t", ",", " ", "betterOm", ",", " ", "b1", ",", " ", "b2", ",", 
        " ", "tauFinal", ",", " ", "taub", ",", " ", "T0"}], "}"}], ",", " ", 
      
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "d1", ",", " ", "d2", ",", " ", "ch2"}], 
          "}"}], " ", "=", " ", "gam"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b1", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{"b2", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"taub", " ", "=", " ", 
         RowBox[{"$gamlist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}], "->", 
            RowBox[{"tauB", "[", "m", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fricke", "[", "tau_", "]"}], " ", ":=", " ", 
         RowBox[{"tau", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "tau"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FrickeInv", "[", "taupp_", "]"}], " ", ":=", " ", 
         RowBox[{"taupp", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "taupp"}], "+", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tauppStart", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "Pi"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"Pi", " ", "-", " ", 
             RowBox[{"Arg", "[", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}], "2"]]}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}]]}], 
                 ")"}]]}], "]"}]}], ")"}]}], " ", "-", " ", 
          RowBox[{"n", "/", "2"}], " ", "+", " ", 
          RowBox[{"taupp2Start", " ", "I"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tauppStart", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"corr", " ", "+", " ", "tauppStart"}], ")"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Im", "[", 
             RowBox[{"EichlerZ", "[", 
              RowBox[{"gam", ",", " ", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"corr", " ", "+", " ", "tauppStart"}], "]"}], ",", 
               " ", "m"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"corr", ",", " ", "0", ",", " ", 
              RowBox[{"-", ".01"}], ",", " ", ".01"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"taupp", "'"}], "[", "t", "]"}], " ", "==", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "<", "0"}], ",", " ",
               "0", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}], "*", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", 
                   RowBox[{"taupp", "[", "t", "]"}]}]}], "]"}], "^", "2"}], 
               "*", 
               RowBox[{"Normalize", "[", 
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "r", " ", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", "1"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "^", "8"}], "*", 
                   
                   RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "4"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "6"}]}]}],
                   "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"Om", "[", "t", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"taupp", "[", "0", "]"}], " ", "==", " ", "tauppStart"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"24", "-", 
                RowBox[{"ModularJ4", "[", 
                 RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}], 
              RowBox[{"Om", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "'"}], "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"Pi", " ", "m"}], "]"}], "-", "1"}], ")"}], 
              RowBox[{"J4D", "[", 
               RowBox[{"taupp", "[", "t", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "[", "t", "]"}], "^", "2"}], "*", 
              RowBox[{
               RowBox[{"taupp", "'"}], "[", "t", "]"}]}]}], "==", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Om", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"32", "/", 
              RowBox[{"(", 
               RowBox[{"24", "-", 
                RowBox[{"ModularJ4", "[", "tauppStart", "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", "tauppStart", "]"}], "+", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "taupp", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Arg", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}]}], 
                 RowBox[{"EichlerZ", "[", 
                  RowBox[{"gam", ",", " ", 
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                  "]"}]}], "]"}], "]"}], ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b1", "=", 
                RowBox[{"b1", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"taupp", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"taupp", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{"I", " ", 
                  RowBox[{
                   RowBox[{"Im", "[", 
                    RowBox[{"EichlerZ", "[", 
                    RowBox[{"gam", ",", " ", 
                    RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                    "]"}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "r", " ", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", "1"}], ")"}]}]}],
                     ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "^", "8"}], "*", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "4"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "6"}]}]}],
                     ")"}], "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}]}], "}"}]}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "Om", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{"32", "/", 
                 RowBox[{"(", 
                  RowBox[{"24", "-", 
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], "]"}], 
              ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b2", "=", 
                RowBox[{"b2", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"Om", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                    
                    RowBox[{"32", "/", 
                    RowBox[{"(", 
                    RowBox[{"24", "-", 
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Stop", " ", "if", " ", "we", " ", "hit", " ", "the", " ", 
             "boundaries", " ", "or", " ", "reach", " ", "the", " ", 
             "massless", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"EichlerZ", "[", 
                RowBox[{"gam", ",", " ", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "20"}], ")"}]}]}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "]"}], "<", "eps"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "]"}], ">", "1"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "-", "#"}], 
                  "]"}], "&"}], "/@", "taub"}], "]"}], "<", "eps"}], ",", 
             " ", "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]",
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"NDSolve", "[", 
            RowBox[{"eqns", ",", " ", 
             RowBox[{"{", 
              RowBox[{"taupp", ",", " ", "Om"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"StepMonitor", ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sMonitor", " ", "=", " ", "t"}], ";", " ", 
                RowBox[{"tauMonitor", "=", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taupp", "[", "t", "]"}], "]"}]}], ";", " ", 
                RowBox[{"OmMonitor", "=", 
                 RowBox[{"Om", "[", "t", "]"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MaxStepSize", "->", "0.001"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "sMonitor", ",", " ", "tauMonitor", ",", " ", "OmMonitor"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$Debug", "||", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "b1", ",", " ", "\"\< bumps in taupp, \>\"", ",", " ", "b2", ",", 
             " ", "\"\< bumps in Om\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"T0", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Piecewise", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"ArcTan", "[", 
                    FractionBox[
                    RowBox[{"2", " ", 
                    RowBox[{"Im", "[", "tauppStart", "]"}]}], 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}]], "]"}]}]}], 
                    RowBox[{"2", " ", "\[Pi]"}]], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Re", "[", "tauppStart", "]"}], "<", 
                    RowBox[{"-", 
                    FractionBox["1", "2"]}]}]}], "}"}], ",", "  ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Ceiling", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"ArcTan", "[", 
                    FractionBox[
                    RowBox[{"2", " ", 
                    RowBox[{"Im", "[", "tauppStart", "]"}]}], 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}]], "]"}]}]}], 
                    RowBox[{"2", " ", "\[Pi]"}]], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"Re", "[", "tauppStart", "]"}], ">", 
                    RowBox[{"-", 
                    FractionBox["1", "2"]}]}]}], "}"}]}], "}"}], ",", " ", 
               "0"}], "]"}], "\[Pi]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"ArcTan", "[", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"Im", "[", "tauppStart", "]"}]}], 
               RowBox[{"1", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Re", "[", "tauppStart", "]"}]}]}]], "]"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               RowBox[{"Re", "[", "tauppStart", "]"}]}]}], ")"}]}], ")"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"tauppStart", ",", " ", "T0"}], "}"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauFinal", "[", "t_", "]"}], " ", ":=", " ", 
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "tauppStart", "]"}]}], "-", 
                  RowBox[{
                   FractionBox["1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], ")"}], " ", 
                   RowBox[{"Tan", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "t"}], "-", 
                    RowBox[{"ArcTan", "[", 
                    FractionBox[
                    RowBox[{"2", " ", 
                    RowBox[{"Im", "[", "tauppStart", "]"}]}], 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}]], "]"}], "+", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], "]"}]}]}], 
                 ")"}]}], " ", "+", " ", "tauppStart"}], ",", " ", 
              RowBox[{"t", "<", "0"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"taupp", "[", "t", "]"}], "/.", 
               RowBox[{"First", "@", "soln"}]}], ",", " ", 
              RowBox[{"t", ">=", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"FrickeInv", "[", 
             RowBox[{"tauFinal", "[", 
              RowBox[{"Rescale", "[", 
               RowBox[{"#", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Im", "[", "tauppStart", "]"}], " ", "-", " ", 
                    "$maxtaupp2"}], ")"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"taupp", "/.", 
                    RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
                    "\"\<Domain\>\"", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], 
               "]"}], "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FrickeInv", "[", 
             RowBox[{
              RowBox[{"taupp", "[", 
               RowBox[{"Rescale", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"taupp", "/.", 
                    RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
                   "\"\<Domain\>\"", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "/.", 
              RowBox[{"First", "@", "soln"}]}], "]"}], "&"}]}], "}"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FrickeInv", "[", 
            RowBox[{"tauFinal", "[", "#", "]"}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"T0", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"taupp", "/.", 
                RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
              "\"\<Domain\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932713362850424*^9, 3.93271365616076*^9}, {
   3.932713713814685*^9, 3.932713786571229*^9}, 3.9327139000197067`*^9, {
   3.932714025525086*^9, 3.9327140347469273`*^9}, {3.9327141673930187`*^9, 
   3.9327142082190037`*^9}, {3.932714523451254*^9, 3.932714551354928*^9}, {
   3.9327146074523783`*^9, 3.932714616092286*^9}, {3.932714664730444*^9, 
   3.932714700878821*^9}, {3.932715259815342*^9, 3.9327152636361*^9}, {
   3.932715573071046*^9, 3.932715614870385*^9}, {3.93271569251307*^9, 
   3.9327157215247087`*^9}, {3.932791855459231*^9, 3.932791899971588*^9}, {
   3.932791957685053*^9, 3.9327920971133623`*^9}, {3.932792234325576*^9, 
   3.932792262100027*^9}, {3.932793847138021*^9, 3.932793857282599*^9}, {
   3.932793925832597*^9, 3.9327939259597397`*^9}, {3.932794017473398*^9, 
   3.932794017825692*^9}, {3.932794092149885*^9, 3.932794105321526*^9}, {
   3.932794328544186*^9, 3.932794347688314*^9}, {3.932794642982032*^9, 
   3.932794644906739*^9}, {3.9327948158904963`*^9, 3.932794818136239*^9}, {
   3.9327957024759493`*^9, 3.932795715345366*^9}, {3.932798801470724*^9, 
   3.9327988122362127`*^9}, {3.9327988522374973`*^9, 3.932798863882535*^9}, {
   3.932798895517037*^9, 3.932798895803554*^9}, {3.932799023331348*^9, 
   3.9327990241903954`*^9}, {3.932810609494754*^9, 3.932810617650084*^9}, {
   3.932810667219152*^9, 3.93281070351103*^9}, {3.932810789618804*^9, 
   3.932810937070546*^9}, {3.932811144991497*^9, 3.9328111498920593`*^9}, {
   3.9328122464771643`*^9, 3.932812251189698*^9}, {3.9328226179321632`*^9, 
   3.932822622680921*^9}, {3.932882256283701*^9, 3.932882271832445*^9}, {
   3.932882827763298*^9, 3.93288285494998*^9}, 3.9328841094046593`*^9, {
   3.9329635581090393`*^9, 3.932963559032154*^9}, {3.932963625657847*^9, 
   3.9329636299077187`*^9}, {3.932963998420763*^9, 3.93296403075091*^9}, {
   3.932964118619417*^9, 3.9329641193270407`*^9}, {3.932964818631405*^9, 
   3.9329648731134977`*^9}, {3.932964904964711*^9, 3.932964922555772*^9}, {
   3.932977272143495*^9, 3.9329772722926073`*^9}, {3.932977655557644*^9, 
   3.932977667057036*^9}, {3.93297771405564*^9, 3.93297772980873*^9}, {
   3.932977789359194*^9, 3.932977791050273*^9}, {3.932977821610177*^9, 
   3.932977928676298*^9}, 3.932978025720131*^9, {3.933059634623599*^9, 
   3.933059636881735*^9}, {3.933059704314724*^9, 3.933059704450354*^9}, {
   3.933059770066778*^9, 3.933059771887534*^9}, {3.933063090436913*^9, 
   3.933063094290524*^9}, {3.9330631541302147`*^9, 3.933063170223859*^9}, {
   3.933063241052142*^9, 3.933063249927589*^9}, 3.93306344993137*^9, 
   3.9330636720485983`*^9, {3.9330638710119457`*^9, 3.933063872587737*^9}, {
   3.933066376894758*^9, 3.933066379360834*^9}, {3.93306644330031*^9, 
   3.933066445725418*^9}, {3.9330665030560913`*^9, 3.933066536434999*^9}, {
   3.933066568690029*^9, 3.933066568842873*^9}, {3.933066728739686*^9, 
   3.9330667294938097`*^9}, {3.9330694957454977`*^9, 3.933069497938573*^9}, {
   3.933069767249969*^9, 3.933069769335197*^9}, {3.933069899737638*^9, 
   3.933069901956675*^9}, {3.9330699546475143`*^9, 3.9330699552564373`*^9}, {
   3.933070023316614*^9, 3.9330700516120043`*^9}, {3.933138343794529*^9, 
   3.933138362975268*^9}, {3.933493141510747*^9, 3.933493190897071*^9}, {
   3.933493623407755*^9, 3.933493653313841*^9}, {3.933493684158092*^9, 
   3.933493686385169*^9}, {3.933493737802101*^9, 3.9334937756348057`*^9}, {
   3.9334938137874193`*^9, 3.9334938168125277`*^9}, {3.9336652085542927`*^9, 
   3.933665260834981*^9}, {3.933665527920453*^9, 3.9336655320905533`*^9}, {
   3.933665584699421*^9, 3.933665589632558*^9}, {3.933665746496624*^9, 
   3.9336657465855427`*^9}, 3.933665794965383*^9, {3.9336659822619553`*^9, 
   3.9336659983986883`*^9}, {3.933666192899981*^9, 3.933666232822075*^9}, {
   3.9336670365342417`*^9, 3.933667036604164*^9}, {3.933667086082601*^9, 
   3.933667105854434*^9}, {3.933667176995298*^9, 3.93366718472071*^9}, {
   3.933667225736125*^9, 3.933667234296444*^9}, {3.933667293397189*^9, 
   3.933667325855666*^9}, {3.9336674051031227`*^9, 3.933667429724337*^9}, {
   3.9336674883062773`*^9, 3.933667503140896*^9}, {3.933667534846253*^9, 
   3.9336675723098497`*^9}, {3.933667772661641*^9, 3.93366781606597*^9}, {
   3.93366786011051*^9, 3.933667880119355*^9}, {3.9336683193241177`*^9, 
   3.933668325398987*^9}, {3.933668361997951*^9, 3.93366839864473*^9}, {
   3.933668839401518*^9, 3.93366884245477*^9}, {3.9336717551342154`*^9, 
   3.9336718599108543`*^9}, {3.933671986986115*^9, 3.933672004798912*^9}, {
   3.933672035313397*^9, 3.933672067300548*^9}, {3.93367292365493*^9, 
   3.933673030840526*^9}, {3.933673090482471*^9, 3.93367312776889*^9}, {
   3.933673165461659*^9, 3.9336731662838173`*^9}, {3.933673199948845*^9, 
   3.933673206644888*^9}, {3.9336773208475246`*^9, 3.9336773209611883`*^9}, 
   3.933755258745041*^9, {3.9337559055369377`*^9, 3.933755907161977*^9}, {
   3.933755948667671*^9, 3.933755949202366*^9}, {3.933756178698022*^9, 
   3.933756179375443*^9}, {3.9337562485264797`*^9, 3.933756248618555*^9}, {
   3.933756382594378*^9, 3.933756396628284*^9}, {3.9337566934451714`*^9, 
   3.933756703767231*^9}, 3.93375735790252*^9, {3.933757715974639*^9, 
   3.933757726680503*^9}, {3.933757934579176*^9, 3.933757940067515*^9}, 
   3.933757998223255*^9, {3.9337606448350163`*^9, 3.933760651212722*^9}, {
   3.933760821686618*^9, 3.9337608258393793`*^9}, 3.933767835448709*^9, {
   3.933821779781007*^9, 3.933821780936205*^9}, {3.933950340742382*^9, 
   3.933950343793185*^9}, {3.934447333239983*^9, 3.9344473405462008`*^9}, {
   3.9345283044900827`*^9, 3.934528326739912*^9}, {3.934529623994985*^9, 
   3.934529631409114*^9}, {3.934531232019226*^9, 3.93453123230328*^9}, {
   3.934531845883524*^9, 3.9345319152603607`*^9}, 3.934531966378949*^9, 
   3.934532066134775*^9, {3.934532113464443*^9, 3.9345321359721317`*^9}, {
   3.934532171198275*^9, 3.93453224136126*^9}, {3.934532299267088*^9, 
   3.9345323041826143`*^9}, {3.934532341988682*^9, 3.934532350887042*^9}, {
   3.9345324241356707`*^9, 3.934532425977682*^9}, {3.9345324941767483`*^9, 
   3.934532528663411*^9}, {3.93453267853615*^9, 3.934532678809845*^9}, 
   3.934532867637179*^9, {3.934532982389289*^9, 3.934532984085045*^9}, 
   3.93453423913899*^9, {3.935645773873046*^9, 3.93564577761579*^9}, {
   3.935645889111945*^9, 3.935645892524354*^9}, {3.9356459925194483`*^9, 
   3.935646009534893*^9}, 3.935646056572377*^9, 3.93654852991341*^9, 
   3.936549619903863*^9, {3.93712139669977*^9, 3.937121397060917*^9}, {
   3.940501455529209*^9, 3.9405015295336103`*^9}, {3.9405019364571333`*^9, 
   3.9405019387772818`*^9}, {3.940502075469195*^9, 3.940502077857218*^9}, {
   3.9405021730244207`*^9, 3.94050217432143*^9}, 3.9405022091579103`*^9, 
   3.9405715127904797`*^9, {3.94057156114546*^9, 3.9405716032577353`*^9}, {
   3.940572617230576*^9, 3.940572628914781*^9}, {3.940572800315884*^9, 
   3.9405728063807583`*^9}, {3.940572983169146*^9, 3.9405730781306267`*^9}, {
   3.940573116846057*^9, 3.9405731370664873`*^9}, {3.940573303921523*^9, 
   3.9405733047410316`*^9}, {3.940573351488578*^9, 3.940573393479906*^9}, {
   3.940573475189695*^9, 3.94057347930722*^9}, {3.9405735128981047`*^9, 
   3.940573519448023*^9}, 3.940585942091548*^9, {3.9417778940111513`*^9, 
   3.9417779026401367`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"89316259-3ba7-4aad-9f2b-bc200931f2b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RayProperA", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RayProperA", "[", 
    RowBox[{"gam_", ",", " ", "m_", ",", " ", 
     RowBox[{"psi_", ":", "0"}], ",", " ", 
     RowBox[{"n_", ":", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"RayProperA", "[", 
     RowBox[{"gam", ",", " ", "m", ",", " ", "psi", ",", " ", "n"}], "]"}], 
    " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eps", " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}]}], ",", 
        RowBox[{"taup2Start", " ", "=", " ", "4"}], ",", " ", "T0", ",", " ", 
        "taupStart", ",", " ", "eqns", ",", " ", "soln", ",", " ", "corr", 
        ",", " ", "Fricke", ",", " ", "FrickeInv", ",", " ", "r", ",", " ", 
        "d1", ",", " ", "d2", ",", " ", "ch2", ",", " ", "taup", ",", " ", 
        "Om", ",", " ", "t", ",", " ", "betterOm", ",", " ", "b1", ",", " ", 
        "b2", ",", " ", "tauFinal", ",", " ", "taub"}], "}"}], ",", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "d1", ",", " ", "d2", ",", " ", "ch2"}], 
          "}"}], " ", "=", " ", "gam"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b1", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{"b2", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"taub", " ", "=", " ", 
         RowBox[{"$gamlist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}], "->", 
            RowBox[{"tauB", "[", "m", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fricke", "[", "tau_", "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", "*", "tau"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"FrickeInv", " ", "=", " ", "Fricke"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"taupStart", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", "Pi"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"psi", " ", "+", " ", 
             RowBox[{"Pi", "/", "2"}], " ", "-", " ", 
             RowBox[{"Arg", "[", 
              FractionBox[
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}], "2"]], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}]]}], 
                ")"}]], "]"}]}], ")"}]}], " ", "-", " ", 
          RowBox[{"n", "/", "2"}], " ", "+", " ", 
          RowBox[{"taup2Start", " ", "I"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"taupStart", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"corr", " ", "+", " ", "taupStart"}], ")"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", "psi"}], "]"}], " ", 
              RowBox[{"EichlerZ", "[", 
               RowBox[{"gam", ",", " ", 
                RowBox[{"FrickeInv", "[", 
                 RowBox[{"corr", " ", "+", " ", "taupStart"}], "]"}], ",", 
                " ", "m"}], "]"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"corr", ",", " ", "0", ",", " ", 
              RowBox[{"-", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}]}]}], ",", " ", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}]}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"taup", "'"}], "[", "t", "]"}], " ", "==", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "<", "0"}], ",", " ", 
              "0", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "psi"}], "]"}], "*", "4", "*", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "2"}], "*", 
               RowBox[{"Normalize", "[", 
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "r"}], "+", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}], 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "4"}], "*", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "6"}], "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "4"}]}]}], 
                  "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"Om", "[", "t", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"taup", "[", "0", "]"}], " ", "==", " ", "taupStart"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ModularJ4", "[", 
                 RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}], 
              RowBox[{"Om", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "'"}], "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}], ")"}], 
                 RowBox[{
                  RowBox[{"Om", "[", "t", "]"}], "^", "2"}]}], "-", "2"}], 
               ")"}], 
              RowBox[{"J4D", "[", 
               RowBox[{"taup", "[", "t", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"taup", "'"}], "[", "t", "]"}]}]}], "==", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Om", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ModularJ4", "[", "taupStart", "]"}], "+", "8"}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ModularJ4", "[", "taupStart", "]"}], "+", "24", "+", 
                
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", "taupStart", "]"}], "-", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "taupp", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Arg", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}]}], "I", " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], " ", "psi"}], "]"}], 
                 RowBox[{"EichlerZ", "[", 
                  RowBox[{"gam", ",", " ", 
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                  "]"}]}], "]"}], "]"}], ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b1", "=", 
                RowBox[{"b1", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"taup", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"taup", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "psi"}], "]"}], 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "I"}], " ", "psi"}], "]"}], " ", 
                    RowBox[{"EichlerZ", "[", 
                    RowBox[{"gam", ",", " ", 
                    RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                    "]"}]}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"8", "I", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "r"}], "+", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}], 
                    RowBox[{"taup", "[", "t", "]"}]}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "4"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taup", "[", "t", "]"}]}], "]"}], "^", "6"}], "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "^", "4"}]}], "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}]}], "}"}]}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "Om", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], "]"}], 
              ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b2", "=", 
                RowBox[{"b2", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"Om", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "+", "24", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "8"}], ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Stop", " ", "if", " ", "we", " ", "hit", " ", "the", " ", 
             "boundaries", " ", "or", " ", "reach", " ", "the", " ", 
             "massless", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"EichlerZ", "[", 
                RowBox[{"gam", ",", " ", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taup", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "20"}], ")"}]}]}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "]"}], "<", "eps"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taup", "[", "t", "]"}], "]"}], "]"}], ">", "20"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taup", "[", "t", "]"}], "]"}], "-", "#"}], "]"}],
                  "&"}], "/@", "taub"}], "]"}], "<", "eps"}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"NDSolve", "[", 
            RowBox[{"eqns", ",", " ", 
             RowBox[{"{", 
              RowBox[{"taup", ",", " ", "Om"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "0", ",", " ", "20"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"StepMonitor", ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sMonitor", " ", "=", " ", "t"}], ";", " ", 
                RowBox[{"tauMonitor", "=", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taup", "[", "t", "]"}], "]"}]}], ";", " ", 
                RowBox[{"OmMonitor", "=", 
                 RowBox[{"Om", "[", "t", "]"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MaxStepSize", "->", "0.001"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "sMonitor", ",", " ", "tauMonitor", ",", " ", "OmMonitor"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$Debug", "||", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "b1", ",", " ", "\"\< bumps in taupp, \>\"", ",", " ", "b2", ",", 
             " ", "\"\< bumps in Om\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"T0", " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"4", 
             RowBox[{"Re", "[", "taupStart", "]"}]}]]}], 
          RowBox[{"ArcTan", "[", 
           FractionBox[
            RowBox[{"Re", "[", "taupStart", "]"}], 
            RowBox[{"Im", "[", "taupStart", "]"}]], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauFinal", "[", "t_", "]"}], " ", ":=", " ", 
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "taupStart", "]"}], "^", "2"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "]"}], " ", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Im", "[", "taupStart", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "taupStart", "]"}]}], "]"}]}]}], 
                    ")"}]}], ")"}]}], ")"}]}], " ", "+", " ", "taupStart"}], 
              ",", " ", 
              RowBox[{"t", "<", "0"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"taup", "[", "t", "]"}], "/.", 
               RowBox[{"First", "@", "soln"}]}], ",", " ", 
              RowBox[{"t", ">=", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FrickeInv", "[", 
            RowBox[{"tauFinal", "[", "#", "]"}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"T0", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"taup", "/.", 
                RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
              "\"\<Domain\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932713362850424*^9, 3.93271365616076*^9}, {
   3.932713713814685*^9, 3.932713786571229*^9}, 3.9327139000197067`*^9, {
   3.932714025525086*^9, 3.9327140347469273`*^9}, {3.9327141673930187`*^9, 
   3.9327142082190037`*^9}, {3.932714523451254*^9, 3.932714551354928*^9}, {
   3.9327146074523783`*^9, 3.932714616092286*^9}, {3.932714664730444*^9, 
   3.932714700878821*^9}, {3.932715259815342*^9, 3.9327152636361*^9}, {
   3.932715573071046*^9, 3.932715614870385*^9}, {3.93271569251307*^9, 
   3.9327157215247087`*^9}, {3.932791855459231*^9, 3.932791899971588*^9}, {
   3.932791957685053*^9, 3.9327920971133623`*^9}, {3.932792234325576*^9, 
   3.932792262100027*^9}, {3.932793847138021*^9, 3.932793857282599*^9}, {
   3.932793925832597*^9, 3.9327939259597397`*^9}, {3.932794017473398*^9, 
   3.932794017825692*^9}, {3.932794092149885*^9, 3.932794105321526*^9}, {
   3.932794328544186*^9, 3.932794347688314*^9}, {3.932794642982032*^9, 
   3.932794644906739*^9}, {3.9327948158904963`*^9, 3.932794818136239*^9}, {
   3.9327957024759493`*^9, 3.932795715345366*^9}, {3.932798801470724*^9, 
   3.9327988122362127`*^9}, {3.9327988522374973`*^9, 3.932798863882535*^9}, {
   3.932798895517037*^9, 3.932798895803554*^9}, {3.932799023331348*^9, 
   3.9327990241903954`*^9}, {3.932810609494754*^9, 3.932810617650084*^9}, {
   3.932810667219152*^9, 3.93281070351103*^9}, {3.932810789618804*^9, 
   3.932810937070546*^9}, {3.932811144991497*^9, 3.9328111498920593`*^9}, {
   3.9328122464771643`*^9, 3.932812251189698*^9}, {3.9328226179321632`*^9, 
   3.932822622680921*^9}, {3.932882256283701*^9, 3.932882271832445*^9}, {
   3.932882827763298*^9, 3.93288285494998*^9}, 3.9328841094046593`*^9, {
   3.9329635581090393`*^9, 3.932963559032154*^9}, {3.932963625657847*^9, 
   3.9329636299077187`*^9}, {3.932963998420763*^9, 3.93296403075091*^9}, {
   3.932964118619417*^9, 3.9329641193270407`*^9}, {3.932964818631405*^9, 
   3.9329648731134977`*^9}, {3.932964904964711*^9, 3.932964922555772*^9}, {
   3.932977272143495*^9, 3.9329772722926073`*^9}, {3.932977655557644*^9, 
   3.932977667057036*^9}, {3.93297771405564*^9, 3.93297772980873*^9}, {
   3.932977789359194*^9, 3.932977791050273*^9}, {3.932977821610177*^9, 
   3.932977928676298*^9}, 3.932978025720131*^9, {3.933059634623599*^9, 
   3.933059636881735*^9}, {3.933059704314724*^9, 3.933059704450354*^9}, {
   3.933059770066778*^9, 3.933059771887534*^9}, {3.933063090436913*^9, 
   3.933063094290524*^9}, {3.9330631541302147`*^9, 3.933063170223859*^9}, {
   3.933063241052142*^9, 3.933063249927589*^9}, 3.93306344993137*^9, 
   3.9330636720485983`*^9, {3.9330638710119457`*^9, 3.933063872587737*^9}, {
   3.933066376894758*^9, 3.933066379360834*^9}, {3.93306644330031*^9, 
   3.933066445725418*^9}, {3.9330665030560913`*^9, 3.933066536434999*^9}, {
   3.933066568690029*^9, 3.933066568842873*^9}, {3.933066728739686*^9, 
   3.9330667294938097`*^9}, {3.9330694957454977`*^9, 3.933069497938573*^9}, {
   3.933069767249969*^9, 3.933069769335197*^9}, {3.933069899737638*^9, 
   3.933069901956675*^9}, {3.9330699546475143`*^9, 3.9330699552564373`*^9}, {
   3.933070023316614*^9, 3.9330700516120043`*^9}, {3.933138343794529*^9, 
   3.933138362975268*^9}, {3.933493141510747*^9, 3.933493190897071*^9}, {
   3.933493623407755*^9, 3.933493653313841*^9}, {3.933493684158092*^9, 
   3.933493686385169*^9}, {3.933493737802101*^9, 3.9334937756348057`*^9}, {
   3.9334938137874193`*^9, 3.9334938168125277`*^9}, {3.9336652085542927`*^9, 
   3.933665260834981*^9}, {3.933665527920453*^9, 3.9336655320905533`*^9}, {
   3.933665584699421*^9, 3.933665589632558*^9}, {3.933665746496624*^9, 
   3.9336657465855427`*^9}, 3.933665794965383*^9, {3.9336659822619553`*^9, 
   3.9336659983986883`*^9}, {3.933666192899981*^9, 3.933666232822075*^9}, {
   3.9336670365342417`*^9, 3.933667036604164*^9}, {3.933667086082601*^9, 
   3.933667105854434*^9}, {3.933667176995298*^9, 3.93366718472071*^9}, {
   3.933667225736125*^9, 3.933667234296444*^9}, {3.933667293397189*^9, 
   3.933667325855666*^9}, {3.9336674051031227`*^9, 3.933667429724337*^9}, {
   3.9336674883062773`*^9, 3.933667503140896*^9}, {3.933667534846253*^9, 
   3.9336675723098497`*^9}, {3.933667772661641*^9, 3.93366781606597*^9}, {
   3.93366786011051*^9, 3.933667880119355*^9}, {3.9336683193241177`*^9, 
   3.933668325398987*^9}, {3.933668361997951*^9, 3.93366839864473*^9}, {
   3.933668839401518*^9, 3.93366884245477*^9}, {3.9336717551342154`*^9, 
   3.9336718599108543`*^9}, {3.933671986986115*^9, 3.933672004798912*^9}, {
   3.933672035313397*^9, 3.933672067300548*^9}, {3.93367292365493*^9, 
   3.933673030840526*^9}, {3.933673090482471*^9, 3.93367312776889*^9}, {
   3.933673165461659*^9, 3.9336731662838173`*^9}, {3.933673199948845*^9, 
   3.933673206644888*^9}, {3.9336773208475246`*^9, 3.9336773209611883`*^9}, 
   3.933755258745041*^9, {3.9337559055369377`*^9, 3.933755907161977*^9}, {
   3.933755948667671*^9, 3.933755949202366*^9}, {3.933756178698022*^9, 
   3.933756179375443*^9}, {3.9337562485264797`*^9, 3.933756248618555*^9}, {
   3.933756382594378*^9, 3.933756396628284*^9}, {3.9337566934451714`*^9, 
   3.933756703767231*^9}, 3.93375735790252*^9, {3.93375744818052*^9, 
   3.933757474947946*^9}, {3.933757512840372*^9, 3.933757709580661*^9}, {
   3.933757897895005*^9, 3.9337579258707952`*^9}, {3.933757984470583*^9, 
   3.933757987631824*^9}, {3.93376067040038*^9, 3.933760687552709*^9}, {
   3.9337608003289433`*^9, 3.933760815912559*^9}, 3.93376784253043*^9, {
   3.9338217903410063`*^9, 3.93382179141844*^9}, {3.933950349765417*^9, 
   3.933950354213316*^9}, {3.934274648935137*^9, 3.934274651183169*^9}, {
   3.9342746982023287`*^9, 3.93427470935211*^9}, 3.934447349541891*^9, {
   3.934526414415215*^9, 3.9345264181063347`*^9}, {3.9345312098195477`*^9, 
   3.934531210230564*^9}, {3.9345320540448217`*^9, 3.934532058509087*^9}, {
   3.934532255052648*^9, 3.934532290617189*^9}, 3.934532561996172*^9, {
   3.934532644274014*^9, 3.9345326687004557`*^9}, 3.934532771101162*^9, 
   3.934532862722847*^9, 3.934532988302536*^9, {3.934533021610928*^9, 
   3.934533043342924*^9}, {3.934533085377294*^9, 3.934533085511179*^9}, {
   3.934533528829247*^9, 3.934533533416153*^9}, 3.934534229559778*^9, {
   3.93564560535921*^9, 3.935645650278406*^9}, {3.935645903954013*^9, 
   3.935645906202964*^9}, {3.935645953297159*^9, 3.935645980590398*^9}, {
   3.9356460490621357`*^9, 3.9356460497953033`*^9}, {3.936071410098996*^9, 
   3.936071457027878*^9}, 3.93652952231034*^9, {3.936549677705559*^9, 
   3.9365496876213417`*^9}, {3.937120950684512*^9, 3.937120950933942*^9}, {
   3.941715513789006*^9, 3.941715540939156*^9}, {3.9417156080483103`*^9, 
   3.94171565395461*^9}, {3.941715685936812*^9, 3.941715761783379*^9}, {
   3.941716954054513*^9, 3.941717022610899*^9}, {3.9417779643672953`*^9, 
   3.9417779645508223`*^9}, {3.942752508290121*^9, 3.942752510760519*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"beb9eff9-7512-4eb7-9578-413413ad396b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RayProperB", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RayProperB", "[", 
    RowBox[{"gam_", ",", " ", "m_", ",", " ", 
     RowBox[{"psi_", ":", "0"}], ",", " ", 
     RowBox[{"n_", ":", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"RayProperB", "[", 
     RowBox[{"gam", ",", " ", "m", ",", " ", "psi", ",", " ", "n"}], "]"}], 
    " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eps", " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}]}], ",", 
        RowBox[{"taupp2Start", " ", "=", " ", "4"}], ",", " ", "T0", ",", " ",
         "tauppStart", ",", " ", "eqns", ",", " ", "soln", ",", " ", "corr", 
        ",", " ", "Fricke", ",", " ", "FrickeInv", ",", " ", "r", ",", " ", 
        "d1", ",", " ", "d2", ",", " ", "ch2", ",", " ", "taupp", ",", " ", 
        "Om", ",", " ", "t", ",", " ", "betterOm", ",", " ", "b1", ",", " ", 
        "b2", ",", " ", "tauFinal", ",", " ", "taub"}], "}"}], ",", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "d1", ",", " ", "d2", ",", " ", "ch2"}], 
          "}"}], " ", "=", " ", "gam"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b1", " ", "=", " ", "0"}], ";", " ", 
        RowBox[{"b2", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"taub", " ", "=", " ", 
         RowBox[{"$gamlist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Symbol", "[", "\"\<tau\>\"", "]"}], "->", 
            RowBox[{"tauB", "[", "m", "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Fricke", "[", "tau_", "]"}], " ", ":=", " ", 
         RowBox[{"tau", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "tau"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FrickeInv", "[", "taupp_", "]"}], " ", ":=", " ", 
         RowBox[{"taupp", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "taupp"}], "+", "1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tauppStart", " ", "=", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"m", "==", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"psi", "/", "Pi"}], " ", "-", " ", "n"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", "Pi"}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{"psi", " ", "+", " ", 
                RowBox[{"Pi", "/", "2"}], " ", "-", " ", 
                RowBox[{"Arg", "[", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    FractionBox[
                    RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}], 
                    "2"]]}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Pi]"}]]}], 
                    ")"}]]}], "]"}]}], ")"}]}], " ", "-", " ", 
             RowBox[{"n", "/", "2"}]}]}], " ", "]"}], "+", " ", 
          RowBox[{"taupp2Start", " ", "I"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"tauppStart", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"corr", " ", "+", " ", "tauppStart"}], ")"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", "psi"}], "]"}], " ", 
              RowBox[{"EichlerZ", "[", 
               RowBox[{"gam", ",", " ", 
                RowBox[{"FrickeInv", "[", 
                 RowBox[{"corr", " ", "+", " ", "tauppStart"}], "]"}], ",", 
                " ", "m"}], "]"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"corr", ",", " ", "0", ",", " ", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"taupp", "'"}], "[", "t", "]"}], " ", "==", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "<", "0"}], ",", " ",
               "0", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}], "*", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", 
                   RowBox[{"taupp", "[", "t", "]"}]}]}], "]"}], "^", "2"}], 
               "*", 
               RowBox[{"(", 
                RowBox[{"-", "I"}], ")"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "psi"}], "]"}], "*", 
               RowBox[{"Normalize", "[", 
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "r", " ", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", "1"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "^", "8"}], "*", 
                   
                   RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "4"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "6"}]}]}],
                   "]"}], "*", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"Om", "[", "t", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"taupp", "[", "0", "]"}], " ", "==", " ", "tauppStart"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"24", "-", 
                RowBox[{"ModularJ4", "[", 
                 RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}], 
              RowBox[{"Om", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "'"}], "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"Pi", " ", "m"}], "]"}], "-", "1"}], ")"}], 
              RowBox[{"J4D", "[", 
               RowBox[{"taupp", "[", "t", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Om", "[", "t", "]"}], "^", "2"}], "*", 
              RowBox[{
               RowBox[{"taupp", "'"}], "[", "t", "]"}]}]}], "==", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Om", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"32", "/", 
              RowBox[{"(", 
               RowBox[{"24", "-", 
                RowBox[{"ModularJ4", "[", "tauppStart", "]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ModularJ4", "[", "tauppStart", "]"}], "+", "8"}], 
                  ")"}], 
                 RowBox[{"Cos", "[", 
                  RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "taupp", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"Arg", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}]}], "I", " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], " ", "psi"}], "]"}], 
                 RowBox[{"EichlerZ", "[", 
                  RowBox[{"gam", ",", " ", 
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                  "]"}]}], "]"}], "]"}], ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b1", "=", 
                RowBox[{"b1", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"taupp", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"taupp", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "psi"}], "]"}], 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "I"}], " ", "psi"}], "]"}], " ", 
                    RowBox[{"EichlerZ", "[", 
                    RowBox[{"gam", ",", " ", 
                    RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                    "]"}]}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "r", " ", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d1", "+", "d2"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "+", "1"}], ")"}]}]}],
                     ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "^", "8"}], "*", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"4", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "4"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"DedekindEta", "[", 
                    RowBox[{"2", 
                    RowBox[{"taupp", "[", "t", "]"}]}], "]"}], "^", "6"}]}]}],
                     ")"}], "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}]}], "}"}]}],
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "bump", " ", "Om", " ", "if", " ", "it", " ", "gets", " ", 
              "off"}], "-", "track"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{"32", "/", 
                 RowBox[{"(", 
                  RowBox[{"24", "-", 
                   RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], "]"}], 
              ">", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b2", "=", 
                RowBox[{"b2", "+", "1"}]}], ",", " ", 
               RowBox[{
                RowBox[{"Om", "[", "t", "]"}], " ", "->", " ", 
                RowBox[{
                 RowBox[{"Om", "[", "t", "]"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Om", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                    
                    RowBox[{"32", "/", 
                    RowBox[{"(", 
                    RowBox[{"24", "-", 
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ModularJ4", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "+", "8"}], 
                    ")"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"Pi", " ", "m"}], "]"}]}]}], ")"}]}]}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", 
                    RowBox[{"Om", "[", "t", "]"}]}], ")"}]}]}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Stop", " ", "if", " ", "we", " ", "hit", " ", "the", " ", 
             "boundaries", " ", "or", " ", "reach", " ", "the", " ", 
             "massless", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"EichlerZ", "[", 
                RowBox[{"gam", ",", " ", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taupp", "[", "t", "]"}], "]"}], ",", " ", "m"}], 
                "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "20"}], ")"}]}]}], ",", " ", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "]"}], "<", "eps"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"FrickeInv", "[", 
                RowBox[{"taupp", "[", "t", "]"}], "]"}], "]"}], ">", "20"}], 
             ",", " ", "\"\<StopIntegration\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"FrickeInv", "[", 
                    RowBox[{"taupp", "[", "t", "]"}], "]"}], "-", "#"}], 
                  "]"}], "&"}], "/@", "taub"}], "]"}], "<", "eps"}], ",", 
             " ", "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]",
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"NDSolve", "[", 
            RowBox[{"eqns", ",", " ", 
             RowBox[{"{", 
              RowBox[{"taupp", ",", " ", "Om"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "0", ",", " ", "20"}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"StepMonitor", ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sMonitor", " ", "=", " ", "t"}], ";", " ", 
                RowBox[{"tauMonitor", "=", 
                 RowBox[{"FrickeInv", "[", 
                  RowBox[{"taupp", "[", "t", "]"}], "]"}]}], ";", " ", 
                RowBox[{"OmMonitor", "=", 
                 RowBox[{"Om", "[", "t", "]"}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"MaxStepSize", "->", "0.001"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "sMonitor", ",", " ", "tauMonitor", ",", " ", "OmMonitor"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$Debug", "||", "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "b1", ",", " ", "\"\< bumps in taupp, \>\"", ",", " ", "b2", ",", 
             " ", "\"\< bumps in Om\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"T0", " ", "=", " ", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               RowBox[{"Re", "[", "tauppStart", "]"}]}]}], 
             RowBox[{"2", " ", 
              RowBox[{"Im", "[", "tauppStart", "]"}]}]], "]"}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", 
               RowBox[{"Re", "[", "tauppStart", "]"}]}]}], ")"}]}]]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tauFinal", "[", "t_", "]"}], " ", ":=", " ", 
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{"(", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox[
                    RowBox[{"Im", "[", "tauppStart", "]"}], "2"]}], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], ")"}], "2"]}],
                     ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "t"}], "+", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], "]"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "t"}], "+", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"4", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], ")"}]}], "+", 
                    
                    RowBox[{"4", " ", 
                    RowBox[{"Im", "[", "tauppStart", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"2", " ", "t"}], "+", 
                    RowBox[{"4", " ", "t", " ", 
                    RowBox[{"Re", "[", "tauppStart", "]"}]}]}], "]"}]}]}], 
                    ")"}]}], ")"}]}], ")"}]}], " ", "+", " ", "tauppStart"}], 
              ",", " ", 
              RowBox[{"t", "<", "0"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"taupp", "[", "t", "]"}], "/.", 
               RowBox[{"First", "@", "soln"}]}], ",", " ", 
              RowBox[{"t", ">=", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FrickeInv", "[", 
            RowBox[{"tauFinal", "[", "#", "]"}], "]"}], "&"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"T0", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"taupp", "/.", 
                RowBox[{"First", "@", "soln"}]}], ")"}], "[", 
              "\"\<Domain\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932713362850424*^9, 3.93271365616076*^9}, {
   3.932713713814685*^9, 3.932713786571229*^9}, 3.9327139000197067`*^9, {
   3.932714025525086*^9, 3.9327140347469273`*^9}, {3.9327141673930187`*^9, 
   3.9327142082190037`*^9}, {3.932714523451254*^9, 3.932714551354928*^9}, {
   3.9327146074523783`*^9, 3.932714616092286*^9}, {3.932714664730444*^9, 
   3.932714700878821*^9}, {3.932715259815342*^9, 3.9327152636361*^9}, {
   3.932715573071046*^9, 3.932715614870385*^9}, {3.93271569251307*^9, 
   3.9327157215247087`*^9}, {3.932791855459231*^9, 3.932791899971588*^9}, {
   3.932791957685053*^9, 3.9327920971133623`*^9}, {3.932792234325576*^9, 
   3.932792262100027*^9}, {3.932793847138021*^9, 3.932793857282599*^9}, {
   3.932793925832597*^9, 3.9327939259597397`*^9}, {3.932794017473398*^9, 
   3.932794017825692*^9}, {3.932794092149885*^9, 3.932794105321526*^9}, {
   3.932794328544186*^9, 3.932794347688314*^9}, {3.932794642982032*^9, 
   3.932794644906739*^9}, {3.9327948158904963`*^9, 3.932794818136239*^9}, {
   3.9327957024759493`*^9, 3.932795715345366*^9}, {3.932798801470724*^9, 
   3.9327988122362127`*^9}, {3.9327988522374973`*^9, 3.932798863882535*^9}, {
   3.932798895517037*^9, 3.932798895803554*^9}, {3.932799023331348*^9, 
   3.9327990241903954`*^9}, {3.932810609494754*^9, 3.932810617650084*^9}, {
   3.932810667219152*^9, 3.93281070351103*^9}, {3.932810789618804*^9, 
   3.932810937070546*^9}, {3.932811144991497*^9, 3.9328111498920593`*^9}, {
   3.9328122464771643`*^9, 3.932812251189698*^9}, {3.9328226179321632`*^9, 
   3.932822622680921*^9}, {3.932882256283701*^9, 3.932882271832445*^9}, {
   3.932882827763298*^9, 3.93288285494998*^9}, 3.9328841094046593`*^9, {
   3.9329635581090393`*^9, 3.932963559032154*^9}, {3.932963625657847*^9, 
   3.9329636299077187`*^9}, {3.932963998420763*^9, 3.93296403075091*^9}, {
   3.932964118619417*^9, 3.9329641193270407`*^9}, {3.932964818631405*^9, 
   3.9329648731134977`*^9}, {3.932964904964711*^9, 3.932964922555772*^9}, {
   3.932977272143495*^9, 3.9329772722926073`*^9}, {3.932977655557644*^9, 
   3.932977667057036*^9}, {3.93297771405564*^9, 3.93297772980873*^9}, {
   3.932977789359194*^9, 3.932977791050273*^9}, {3.932977821610177*^9, 
   3.932977928676298*^9}, 3.932978025720131*^9, {3.933059634623599*^9, 
   3.933059636881735*^9}, {3.933059704314724*^9, 3.933059704450354*^9}, {
   3.933059770066778*^9, 3.933059771887534*^9}, {3.933063090436913*^9, 
   3.933063094290524*^9}, {3.9330631541302147`*^9, 3.933063170223859*^9}, {
   3.933063241052142*^9, 3.933063249927589*^9}, 3.93306344993137*^9, 
   3.9330636720485983`*^9, {3.9330638710119457`*^9, 3.933063872587737*^9}, {
   3.933066376894758*^9, 3.933066379360834*^9}, {3.93306644330031*^9, 
   3.933066445725418*^9}, {3.9330665030560913`*^9, 3.933066536434999*^9}, {
   3.933066568690029*^9, 3.933066568842873*^9}, {3.933066728739686*^9, 
   3.9330667294938097`*^9}, {3.9330694957454977`*^9, 3.933069497938573*^9}, {
   3.933069767249969*^9, 3.933069769335197*^9}, {3.933069899737638*^9, 
   3.933069901956675*^9}, {3.9330699546475143`*^9, 3.9330699552564373`*^9}, {
   3.933070023316614*^9, 3.9330700516120043`*^9}, {3.933138343794529*^9, 
   3.933138362975268*^9}, {3.933493141510747*^9, 3.933493190897071*^9}, {
   3.933493623407755*^9, 3.933493653313841*^9}, {3.933493684158092*^9, 
   3.933493686385169*^9}, {3.933493737802101*^9, 3.9334937756348057`*^9}, {
   3.9334938137874193`*^9, 3.9334938168125277`*^9}, {3.9336652085542927`*^9, 
   3.933665260834981*^9}, {3.933665527920453*^9, 3.9336655320905533`*^9}, {
   3.933665584699421*^9, 3.933665589632558*^9}, {3.933665746496624*^9, 
   3.9336657465855427`*^9}, 3.933665794965383*^9, {3.9336659822619553`*^9, 
   3.9336659983986883`*^9}, {3.933666192899981*^9, 3.933666232822075*^9}, {
   3.9336670365342417`*^9, 3.933667036604164*^9}, {3.933667086082601*^9, 
   3.933667105854434*^9}, {3.933667176995298*^9, 3.93366718472071*^9}, {
   3.933667225736125*^9, 3.933667234296444*^9}, {3.933667293397189*^9, 
   3.933667325855666*^9}, {3.9336674051031227`*^9, 3.933667429724337*^9}, {
   3.9336674883062773`*^9, 3.933667503140896*^9}, {3.933667534846253*^9, 
   3.9336675723098497`*^9}, {3.933667772661641*^9, 3.93366781606597*^9}, {
   3.93366786011051*^9, 3.933667880119355*^9}, {3.9336683193241177`*^9, 
   3.933668325398987*^9}, {3.933668361997951*^9, 3.93366839864473*^9}, {
   3.933668839401518*^9, 3.93366884245477*^9}, {3.9336717551342154`*^9, 
   3.9336718599108543`*^9}, {3.933671986986115*^9, 3.933672004798912*^9}, {
   3.933672035313397*^9, 3.933672067300548*^9}, {3.93367292365493*^9, 
   3.933673030840526*^9}, {3.933673090482471*^9, 3.93367312776889*^9}, {
   3.933673165461659*^9, 3.9336731662838173`*^9}, {3.933673199948845*^9, 
   3.933673206644888*^9}, {3.9336773208475246`*^9, 3.9336773209611883`*^9}, 
   3.933755258745041*^9, {3.9337559055369377`*^9, 3.933755907161977*^9}, {
   3.933755948667671*^9, 3.933755949202366*^9}, {3.933756178698022*^9, 
   3.933756179375443*^9}, {3.9337562485264797`*^9, 3.933756248618555*^9}, {
   3.933756382594378*^9, 3.933756396628284*^9}, {3.9337566934451714`*^9, 
   3.933756703767231*^9}, 3.93375735790252*^9, {3.933757715974639*^9, 
   3.933757726680503*^9}, {3.933757934579176*^9, 3.933757940067515*^9}, 
   3.933757998223255*^9, {3.9337606448350163`*^9, 3.933760651212722*^9}, {
   3.933760821686618*^9, 3.9337608258393793`*^9}, 3.933767835448709*^9, {
   3.933821779781007*^9, 3.933821780936205*^9}, {3.933950340742382*^9, 
   3.933950343793185*^9}, {3.934447333239983*^9, 3.9344473405462008`*^9}, {
   3.9345283044900827`*^9, 3.934528326739912*^9}, {3.934529623994985*^9, 
   3.934529631409114*^9}, {3.934531232019226*^9, 3.93453123230328*^9}, {
   3.934531845883524*^9, 3.9345319152603607`*^9}, 3.934531966378949*^9, 
   3.934532066134775*^9, {3.934532113464443*^9, 3.9345321359721317`*^9}, {
   3.934532171198275*^9, 3.93453224136126*^9}, {3.934532299267088*^9, 
   3.9345323041826143`*^9}, {3.934532341988682*^9, 3.934532350887042*^9}, {
   3.9345324241356707`*^9, 3.934532425977682*^9}, {3.9345324941767483`*^9, 
   3.934532528663411*^9}, {3.93453267853615*^9, 3.934532678809845*^9}, 
   3.934532867637179*^9, {3.934532982389289*^9, 3.934532984085045*^9}, 
   3.93453423913899*^9, {3.935645773873046*^9, 3.93564577761579*^9}, {
   3.935645889111945*^9, 3.935645892524354*^9}, {3.9356459925194483`*^9, 
   3.935646009534893*^9}, 3.935646056572377*^9, 3.93654852991341*^9, 
   3.936549619903863*^9, {3.93712139669977*^9, 3.937121397060917*^9}, {
   3.941717208137072*^9, 3.9417172129221478`*^9}, {3.941717245423946*^9, 
   3.9417172851154947`*^9}, {3.9417183351031733`*^9, 3.941718336995927*^9}, {
   3.941718373852956*^9, 3.941718408233127*^9}, 3.942490388317314*^9, {
   3.942490673773679*^9, 3.942490673847357*^9}, {3.94275181914016*^9, 
   3.9427518221832743`*^9}, {3.942752422197761*^9, 3.942752422561674*^9}, {
   3.942752471406151*^9, 3.942752471498369*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"8fd12ff1-2ab7-401d-8845-8fbeb648d2e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RayManual", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RayManual", "[", 
   RowBox[{"gam_", ",", " ", "m_", ",", " ", "psi_", ",", " ", "tauStart_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"RayManual", "[", 
    RowBox[{"gam", ",", " ", "m", ",", " ", "psi", ",", " ", "tauStart"}], 
    "]"}], " ", "=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tau", ",", "eqns", ",", " ", "soln"}], "\[IndentingNewLine]", 
      "}"}], ",", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqns", " ", "=", " ", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"tau", "'"}], "[", "t", "]"}], " ", "==", " ", 
           RowBox[{"I", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"I", " ", "psi"}], "]"}], " ", "*", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"Normalize", "[", 
              RowBox[{"DtauZ", "[", 
               RowBox[{"gam", ",", " ", 
                RowBox[{"tau", "[", "t", "]"}], ",", " ", "m"}], "]"}], "]"}],
              "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tau", "[", "0", "]"}], " ", "==", " ", "tauStart"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"tau", "[", "t", "]"}], "]"}], ">", "1"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"tau", "[", "t", "]"}], "]"}], "<", ".003"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", " ", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{"eqns", ",", " ", "tau", ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "5"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"StepMonitor", ":>", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sMonitor", " ", "=", " ", "t"}], ";", " ", 
               RowBox[{"tauMonitor", "=", 
                RowBox[{"tau", "[", "t", "]"}]}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"sMonitor", ",", " ", "tauMonitor"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"NormalizeFunctionDomain", "[", 
        RowBox[{"tau", "/.", 
         RowBox[{"First", "@", "soln"}]}], "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.935645285921793*^9, 3.935645417998157*^9}, {
  3.936530904549271*^9, 3.93653092968493*^9}, {3.9365313891663933`*^9, 
  3.9365313899694033`*^9}, {3.9375587697456417`*^9, 3.937558770236268*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"330bc951-048e-4938-87fa-a4eef198f839"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RescaleRayProper", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RescaleRayProper", "[", 
    RowBox[{"{", 
     RowBox[{"ray_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"t0_", ",", " ", "t1_"}], "}"}]}], "}"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"ray", "[", 
     RowBox[{"Rescale", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t0", ",", " ", "t1"}], "}"}]}], "]"}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.941739154937235*^9, 3.9417392080924597`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"61f5ce70-5cf5-4ebb-83f2-bfa30dc49c7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "PiStart", ",", " ", "PiPlot", ",", " ", "PiLabel", ",", " ", "PiShift"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiStart", "[", 
    RowBox[{"RayPi", "[", 
     RowBox[{"tauStart_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"gam_", ",", " ", "n_"}], "}"}], ",", " ", "func_", ",", " ", 
      "etc___"}], "]"}], "]"}], ":=", "tauStart"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiPlot", "[", 
    RowBox[{"RayPi", "[", 
     RowBox[{"tauStart_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"gam_", ",", " ", "n_"}], "}"}], ",", " ", "func_", ",", " ", 
      "etc___"}], "]"}], "]"}], ":=", "func"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiLabel", "[", 
    RowBox[{"RayPi", "[", 
     RowBox[{"tauStart_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"gam_", ",", " ", "n_"}], "}"}], ",", " ", "func_", ",", " ", 
      "etc___"}], "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"gam", ",", " ", "n"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiShift", "[", 
    RowBox[{
     RowBox[{"RayPi", "[", 
      RowBox[{"tauStart_", ",", " ", 
       RowBox[{"{", 
        RowBox[{"gam_", ",", " ", "n_"}], "}"}], ",", " ", "func_", ",", " ", 
       "etc___"}], "]"}], ",", " ", "shift_"}], "]"}], " ", ":=", " ", 
   RowBox[{"RayPi", "[", 
    RowBox[{
     RowBox[{"tauStart", "+", "shift"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MonodromyOnCharge", "[", 
        RowBox[{
         RowBox[{"MatrixPower", "[", 
          RowBox[{"MLV", ",", " ", "shift"}], "]"}], ",", " ", "gam"}], "]"}],
        ",", " ", "n"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"func", "[", "#", "]"}], "+", "shift"}], "]"}], "&"}], ",", 
     " ", "etc"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.937559324232354*^9, 3.937559328056945*^9}, {
  3.942999976311841*^9, 3.942999994322546*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"bd7ccd30-60e5-43f9-8fda-84d55713db33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GeneratePrimaryRays", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratePrimaryRays", "[", 
    RowBox[{"m_", ",", " ", "psi_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"GeneratePrimaryRays", "[", 
     RowBox[{"m", ",", " ", "psi"}], "]"}], " ", "=", " ", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RayPi", "[", 
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "#2", ",", " ", 
         RowBox[{"#1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Ch", "[", 
              RowBox[{"0", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ", 
            
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "\"\<A\>\""}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Ch", "[", 
               RowBox[{"0", ",", " ", "0"}], "]"}]}], "/.", "repCh"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "\"\<A\>\""}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Ch", "[", 
              RowBox[{"1", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ", 
            
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "\"\<A\>\""}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Ch", "[", 
               RowBox[{"1", ",", " ", "0"}], "]"}]}], "/.", "repCh"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "\"\<A\>\""}], "}"}]}], "}"}]}], "}"}], 
        ",", " ", 
        RowBox[{"RescaleRayProper", "/@", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RayProperA", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Ch", "[", 
               RowBox[{"0", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ",
              "m", ",", " ", "psi", ",", " ", "0"}], "]"}], ",", " ", 
           RowBox[{"RayProperA", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Ch", "[", 
               RowBox[{"0", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ",
              "m", ",", " ", "psi", ",", " ", "1"}], "]"}], ",", " ", 
           RowBox[{"RayProperB", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Ch", "[", 
               RowBox[{"1", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ",
              "m", ",", " ", "psi", ",", " ", "0"}], "]"}], ",", " ", 
           RowBox[{"RayProperB", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Ch", "[", 
               RowBox[{"1", ",", " ", "0"}], "]"}], "/.", "repCh"}], ",", " ",
              "m", ",", " ", "psi", ",", " ", "1"}], "]"}]}], "}"}]}]}], 
       "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.941777662313157*^9, 3.941777793043972*^9}, {
  3.941777830151808*^9, 3.941777834133799*^9}, {3.941787967901763*^9, 
  3.94178796949023*^9}, {3.941788001621591*^9, 3.941788004268067*^9}, {
  3.941788362643086*^9, 3.9417884764674397`*^9}, {3.941788514100834*^9, 
  3.941788517294601*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"e34833a7-21c3-4284-833f-f385989fef89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiPoint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiPoint", "[", 
    RowBox[{
     RowBox[{"RayPi", "[", 
      RowBox[{"gam_", ",", " ", "func_", ",", " ", "etc___"}], "]"}], ",", 
     " ", "T_"}], "]"}], " ", ":=", " ", 
   RowBox[{"func", "[", "T", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9417885807026463`*^9, 3.9417886447012453`*^9}, {
  3.941788676534463*^9, 3.941788689076852*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"d399bac7-c99a-467a-b892-2d8c35241369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiGam", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiGam", "[", 
    RowBox[{"RayPi", "[", 
     RowBox[{"gam_", ",", " ", "func_", ",", " ", "etc___"}], "]"}], "]"}], 
   " ", ":=", " ", "gam"}], ";"}]}], "Input",
 CellChangeTimes->{{3.941789807604916*^9, 3.941789812588105*^9}, {
  3.941789957316668*^9, 3.941789957748375*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"c36af7c6-b0a5-4f51-9447-0bb9127f74f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiTransform", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiTransform", "[", 
    RowBox[{"M_", ",", " ", 
     RowBox[{"RayPi", "[", 
      RowBox[{"gam_", ",", " ", "func_", ",", " ", "etc___"}], "]"}]}], "]"}],
    " ", ":=", " ", 
   RowBox[{"RayPi", "[", 
    RowBox[{
     RowBox[{"MonodromyOnCharge", "[", 
      RowBox[{"M", ",", " ", "gam"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MonodromyOnTau", "[", 
          RowBox[{"M", ",", " ", "tau"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"tau", "->", 
           RowBox[{"func", "[", "#", "]"}]}], "}"}]}], ")"}], "]"}], "&"}], 
     ",", " ", "etc"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.941788735776952*^9, 3.94178880414642*^9}, {
  3.941789464361026*^9, 3.941789525663391*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"f5ad42e4-3d7b-4079-b810-226569314168"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiIntersect", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PiIntersect", "[", 
   RowBox[{
    RowBox[{"RayPi", "[", 
     RowBox[{"gam1_", ",", " ", "func1_", ",", " ", "etc1___"}], "]"}], ",", 
    " ", 
    RowBox[{"RayPi", "[", 
     RowBox[{"gam2_", ",", " ", "func2_", ",", " ", "etc2___"}], "]"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T1Start_", ":", ".1"}], ",", " ", 
      RowBox[{"T2Start_", ":", ".1"}]}], "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sol", "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sol", " ", "=", " ", 
      RowBox[{"Echo", "@", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"func1", "[", "T1", "]"}], "-", 
             RowBox[{"func2", "[", "T2", "]"}]}], "]"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"Im", "[", 
            RowBox[{
             RowBox[{"func1", "[", "T1", "]"}], "-", 
             RowBox[{"func2", "[", "T2", "]"}]}], "]"}], "==", "0"}]}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"T1", ",", " ", "T1Start", ",", " ", 
           RowBox[{"10", "^", 
            RowBox[{"-", "5"}]}], ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"T2", ",", " ", "T2Start", ",", " ", 
           RowBox[{"10", "^", 
            RowBox[{"-", "5"}]}], ",", " ", "1"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"func1", "[", "T1", "]"}], "/.", "sol"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9419653303791027`*^9, 3.941965338013235*^9}, {
  3.9419653690933743`*^9, 3.941965479039513*^9}, {3.941965524493248*^9, 
  3.941965582904903*^9}, {3.941965642894784*^9, 3.941965695095914*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"a68c295f-43f3-4368-8436-506a7d3c8936"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PiIntersectProduce", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PiIntersectProduce", "[", 
    RowBox[{
     RowBox[{"RayPi", "[", 
      RowBox[{"gam1_", ",", " ", "func1_", ",", " ", "etc1___"}], "]"}], ",", 
     " ", 
     RowBox[{"RayPi", "[", 
      RowBox[{"gam2_", ",", " ", "func2_", ",", " ", "etc2___"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"gam1c_", ",", " ", "gam2c_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"m_", ",", " ", "psi_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T1Start_", ":", ".1"}], ",", " ", 
       RowBox[{"T2Start_", ":", ".1"}]}], "}"}], ",", " ", 
     RowBox[{"nMax_", ":", " ", "5"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kappa", ",", " ", "childgams", ",", " ", "tauIntersect", ",", " ", 
       "childrays", ",", " ", "ray"}], "}"}], ",", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tauIntersect", " ", "=", " ", 
        RowBox[{"PiIntersect", "[", 
         RowBox[{
          RowBox[{"RayPi", "[", 
           RowBox[{"gam1", ",", " ", "func1", ",", " ", "etc1"}], "]"}], ",", 
          " ", 
          RowBox[{"RayPi", "[", 
           RowBox[{"gam2", ",", " ", "func2", ",", " ", "etc2"}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"T1Start", ",", " ", "T2Start"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kappa", " ", "=", " ", 
        RowBox[{"Abs", "@", 
         RowBox[{"DSZ", "[", 
          RowBox[{
           RowBox[{"gam1c", "/.", "repCh"}], ",", " ", 
           RowBox[{"gam2c", "/.", "repCh"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"childgams", " ", "=", " ", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"kappa", " ", "n1", " ", "n2"}], "-", 
                   RowBox[{"n1", "^", "2"}], "-", 
                   RowBox[{"n2", "^", "2"}], "+", "1"}], ">=", "0"}], ")"}], "&&", 
                RowBox[{
                 RowBox[{"GCD", "[", 
                  RowBox[{"n1", ",", " ", "n2"}], "]"}], "==", "1"}]}], ",", 
               " ", 
               RowBox[{
                RowBox[{"n1", " ", "gam1c"}], " ", "+", " ", 
                RowBox[{"n2", " ", "gam2c"}]}], ",", " ", "Nothing"}], "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"n1", ",", " ", "1", ",", " ", "nMax"}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"n2", ",", " ", "1", ",", " ", "nMax"}], "}"}]}], "]"}],
            ",", " ", "1"}], "]"}], "/.", "repCh"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"childrays", " ", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ray", " ", "=", " ", 
            RowBox[{"RayManual", "[", 
             RowBox[{
             "cgam", ",", " ", "m", ",", " ", "psi", ",", " ", 
              "tauIntersect"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"RayPi", "[", 
            RowBox[{"cgam", ",", " ", "ray", ",", " ", 
             RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"cgam", ",", " ", "childgams"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"tauIntersect", ",", " ", "childrays"}], "}"}]}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.941966437692321*^9, 3.941966621810264*^9}, {
  3.941966691267474*^9, 3.941966802083592*^9}, {3.9419668519423723`*^9, 
  3.941966886315957*^9}, {3.941966924604151*^9, 3.941966934368761*^9}, {
  3.94196770666364*^9, 3.941967709061363*^9}, {3.941968128160446*^9, 
  3.941968129106769*^9}, {3.941968173906398*^9, 3.941968175031518*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"44cb2616-e69e-4836-95fa-04b56f15b47f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "betterSbis", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterSbis", "::", "usage"}], " ", "=", " ", 
   "\"\<betterS[sval, m] tries to construct a contour of s = sval in the tau \
plane\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterSbis", "::", "outdom"}], " ", "=", " ", 
   "\"\<The starting location tau = `1` is outside the fundamental \
domain\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterSbis", "[", 
    RowBox[{"sval_", ",", " ", "m_", ",", 
     RowBox[{"t2Start_", ":", "4."}], ",", " ", 
     RowBox[{"thEnd_", ":", " ", "5."}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"betterSbis", "[", 
     RowBox[{"sval", ",", " ", "m"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sExact", ",", " ", "deltbs", ",", " ", "t1", ",", " ", "t1Start", ",",
         " ", "t1Guess", ",", " ", "tau", ",", " ", "th", ",", "eqns", ",", 
        " ", "soln"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sExact", "[", "ttau_", "]"}], " ", ":=", 
         RowBox[{
          RowBox[{"Im", "[", 
           RowBox[{"EichlerTD", "[", 
            RowBox[{"ttau", ",", " ", "m"}], "]"}], "]"}], "/", 
          RowBox[{"Im", "[", 
           RowBox[{"EichlerT", "[", 
            RowBox[{"ttau", ",", " ", "m"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deltbs", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"ttau", "-", "sval"}], ")"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"t1Guess", " ", "=", " ", "sval"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"t1Start", " ", "=", " ", 
         RowBox[{"t1", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sExact", "[", 
              RowBox[{"t1", " ", "+", " ", 
               RowBox[{"I", " ", "t2Start"}]}], "]"}], "-", "sval"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"t1", ",", " ", "t1Guess"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CloseToBoundary", "[", 
           RowBox[{
            RowBox[{"t1Start", "+", 
             RowBox[{"I", " ", "t2Start"}]}], ",", " ", "0"}], "]"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"betterSbis", "::", "outdom"}], ",", 
             RowBox[{"t1Start", "+", 
              RowBox[{"I", " ", "t2Start"}]}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"tau", "[", "th", "]"}], ",", " ", "th"}], "]"}], " ", "==",
             " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"tau", "[", "th", "]"}], "]"}], "<", ".01"}], ",", 
              " ", 
              RowBox[{"-", "100"}], ",", " ", 
              RowBox[{"Normalize", "[", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{"DtauT", "[", 
                  RowBox[{
                   RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
                 "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"tau", "[", "th", "]"}], "-", "sval"}], ")"}]}], 
                "]"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tau", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"t1Start", " ", "+", " ", 
             RowBox[{"I", " ", "t2Start"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"tau", "[", "th", "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"EichlerT", "[", 
                RowBox[{
                 RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
               "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{
                RowBox[{"EichlerT", "[", 
                 RowBox[{
                  RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
                "+", "m"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "4"}], ")"}]}]}], ",", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"1", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"3", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"stepsMonitor", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"evalMonitor", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", " ", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"NDSolve", "[", 
            RowBox[{"eqns", ",", " ", "tau", ",", " ", 
             RowBox[{"{", 
              RowBox[{"th", ",", " ", "0", ",", " ", "thEnd"}], "}"}], ",", 
             " ", 
             RowBox[{"StepMonitor", ":>", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sMonitor", " ", "=", " ", "th"}], ";"}], " ", 
               RowBox[{"(*", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"stepsMonitor", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"th", ",", " ", 
                    RowBox[{"tau", "[", "th", "]"}]}], "}"}]}], "]"}], "*)"}],
                ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"EvaluationMonitor", ":>", 
                RowBox[{"(", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"evalMonitor", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"th", ",", " ", 
                    RowBox[{"tau", "[", "th", "]"}]}], "}"}]}], "]"}], 
                 ")"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"MaxStepSize", "->", ".01"}]}], "\[IndentingNewLine]", 
            "]"}], ",", " ", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"sMonitor", "/", "thEnd"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NormalizeFunctionDomain", "[", 
         RowBox[{"(", 
          RowBox[{"tau", "/.", 
           RowBox[{"First", "@", "soln"}]}], ")"}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQLbX0gLW+61vHb+/+2YBoPwtTVxA9U/AamP4T+5Q5
POCt472jcmwg+lajqCeIPmOZ6geiE1L3xoNoNRWDZBCdd/9bMYg2+fmyFEQn
yR+rAtE+Yn/B9JajYg0guqUptwVsno9QD4gOSXjUC6IlU7YvAtEXKg0Wg2iV
D8VXI4H0vzmr7oDonYePvQXRUo8CP4DoCPdD30G0QxAPaxSQLtl2mhNEy1mK
84DogM+HhUB06sczYiA6TOe/NIjeFisjA6LdQnvUQfSd2ZG6IPqPcZsliO74
wmILoqc3LnEC0VN3PnMB0UHVB3zA9jRo+ILorkeJlU0Jbx352JWrQbRyRqHE
WiB9LTlNCkT/sNygBKLfZfZqgGgAydquJw==
  "],
 CellLabel->
  "In[115]:=",ExpressionUUID->"a0681b85-baab-4495-bc35-ea99e11a588b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "betterS", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterS", "::", "usage"}], " ", "=", " ", 
   "\"\<betterS[sval, m] tries to construct a contour of s = sval in the tau \
plane\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterS", "::", "outdom"}], " ", "=", " ", 
   "\"\<The starting location tau = `1` is outside the fundamental \
domain\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterS", "[", 
    RowBox[{"sval_", ",", " ", "m_", ",", 
     RowBox[{"t2Start_", ":", "1."}], ",", " ", 
     RowBox[{"thEnd_", ":", " ", "5."}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"betterS", "[", 
     RowBox[{"sval", ",", " ", "m"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sExact", ",", " ", "deltbs", ",", " ", "t1", ",", " ", "t1Start", ",",
         " ", "t1Guess", ",", " ", "tau", ",", " ", "th", ",", "eqns", ",", 
        " ", "soln"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sExact", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "=", " ", 
              RowBox[{"EichlerT", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}], ",", " ", 
             RowBox[{"TD", " ", "=", " ", 
              RowBox[{"EichlerTD", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}]}], "}"}], ",", " ", 
           RowBox[{
            RowBox[{"Im", "[", 
             RowBox[{"TD", "-", 
              RowBox[{"T", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T", "+", "m"}], ")"}], "\[Conjugate]"}], "/", 
                "2"}]}]}], "]"}], "/", 
            RowBox[{"Im", "[", 
             RowBox[{"T", "+", "m"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deltbs", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ttau", "\[Conjugate]"}], "-", 
           RowBox[{"m", "/", "2"}], "-", "sval"}], ")"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"t1Guess", " ", "=", " ", 
         RowBox[{"sval", " ", "+", " ", 
          RowBox[{
           RowBox[{"Re", "[", "m", "]"}], "/", "2"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"t1Start", " ", "=", " ", 
         RowBox[{"t1", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sExact", "[", 
              RowBox[{"t1", " ", "+", " ", 
               RowBox[{"I", " ", "t2Start"}]}], "]"}], "-", "sval"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"t1", ",", " ", "t1Guess"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CloseToBoundary", "[", 
           RowBox[{
            RowBox[{"t1Start", "+", 
             RowBox[{"I", " ", "t2Start"}]}], ",", " ", "0"}], "]"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"betterS", "::", "outdom"}], ",", 
             RowBox[{"t1Start", "+", 
              RowBox[{"I", " ", "t2Start"}]}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"tau", "[", "th", "]"}], ",", " ", "th"}], "]"}], " ", "==",
             " ", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{"DtauT", "[", 
                RowBox[{
                 RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
               "\[Conjugate]"}], "]"}], "*", 
             RowBox[{"deltbs", "[", 
              RowBox[{"tau", "[", "th", "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tau", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"t1Start", " ", "+", " ", 
             RowBox[{"I", " ", "t2Start"}]}]}], ",", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"WhenEvent", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{"EichlerT", "[", 
                  RowBox[{
                   RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
                 "]"}], "<", 
                SuperscriptBox["10", 
                 RowBox[{"-", "6"}]]}], ",", "\"\<StopIntegration\>\""}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"WhenEvent", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Im", "[", 
                 RowBox[{
                  RowBox[{"EichlerT", "[", 
                   RowBox[{
                    RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
                  "+", "m"}], "]"}], "<", 
                SuperscriptBox["10", 
                 RowBox[{"-", "6"}]]}], ",", "\"\<StopIntegration\>\""}], 
              "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"1", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"3", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"tau", "[", "th", "]"}], "]"}], "<", 
              RowBox[{"10", "^", 
               RowBox[{"-", "3"}]}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{"eqns", ",", " ", "tau", ",", " ", 
           RowBox[{"{", 
            RowBox[{"th", ",", " ", "0", ",", " ", "thEnd"}], "}"}], ",", " ", 
           RowBox[{"StepMonitor", ":>", 
            RowBox[{"(", 
             RowBox[{"sMonitor", " ", "=", " ", "th"}], ")"}]}], ",", " ", 
           RowBox[{"Method", "->", "\"\<ExplicitRungeKutta\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NormalizeFunctionDomain", "[", 
         RowBox[{"(", 
          RowBox[{"tau", "/.", 
           RowBox[{"First", "@", "soln"}]}], ")"}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928586718020154*^9, 3.92858672796667*^9}, {
   3.928586793663123*^9, 3.928586798689648*^9}, {3.9344353591677227`*^9, 
   3.9344353769616537`*^9}, {3.9429130742409277`*^9, 3.942913119024374*^9}, 
   3.9429976793324213`*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"270c0f34-cc55-429f-ac22-3d1d6b84bfeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "betterT", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterT", "::", "usage"}], " ", "=", " ", 
   "\"\<betterT[tval, m] tries to construct a contour of t = tval in the tau \
plane\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterT", "::", "outdom"}], " ", "=", " ", 
   "\"\<The starting location tau = `1` is outside the fundamental \
domain\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betterT", "[", 
    RowBox[{"tval_", ",", " ", "m_", ",", 
     RowBox[{"t1Start_", ":", ".1"}], ",", " ", 
     RowBox[{"thEnd_", ":", " ", "5."}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"betterT", "[", 
     RowBox[{"tval", ",", " ", "m"}], "]"}], " ", "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sExact", ",", " ", "tSqExact", ",", " ", "deltbt", ",", " ", "t2", 
        ",", " ", "t2Start", ",", " ", "t2Guess", ",", " ", "tau", ",", " ", 
        "th", ",", "eqns", ",", " ", "soln"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sExact", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "=", " ", 
              RowBox[{"EichlerT", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}], ",", " ", 
             RowBox[{"TD", " ", "=", " ", 
              RowBox[{"EichlerTD", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}]}], "}"}], ",", " ", 
           RowBox[{
            RowBox[{"Im", "[", 
             RowBox[{"TD", "-", 
              RowBox[{"T", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"T", "+", "m"}], ")"}], "\[Conjugate]"}], "/", 
                "2"}]}]}], "]"}], "/", 
            RowBox[{"Im", "[", 
             RowBox[{"T", "+", "m"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tSqExact", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "=", " ", 
              RowBox[{"EichlerT", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}], ",", " ", 
             RowBox[{"TD", " ", "=", " ", 
              RowBox[{"EichlerTD", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}]}], "}"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"T", " ", 
                RowBox[{"TD", "\[Conjugate]"}]}], "]"}], "/", 
              RowBox[{"Im", "[", 
               RowBox[{"(", 
                RowBox[{"T", "+", "m"}], ")"}], "]"}]}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", 
                RowBox[{"TD", "-", 
                 RowBox[{"T", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"T", "+", "m"}], ")"}], "\[Conjugate]"}], "/", 
                   "2"}]}]}], "]"}], "/", 
               RowBox[{"Im", "[", 
                RowBox[{"(", 
                 RowBox[{"T", "+", "m"}], ")"}], "]"}]}], ")"}], "^", 
             "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deltbt", "[", "ttau_", "]"}], " ", ":=", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "=", " ", 
              RowBox[{"EichlerT", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}], ",", " ", 
             RowBox[{"TD", " ", "=", " ", 
              RowBox[{"EichlerTD", "[", 
               RowBox[{"ttau", ",", " ", "m"}], "]"}]}]}], "}"}], ",", " ", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"ttau", "\[Conjugate]"}], " ", "T"}], " ", "-", " ", 
             RowBox[{"2", " ", "TD"}], " ", "-", " ", 
             RowBox[{"tval", "^", "2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"sExact", "[", "ttau", "]"}], "^", "2"}], " ", "-", " ", 
             RowBox[{"2", 
              RowBox[{"sExact", "[", "ttau", "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ttau", "\[Conjugate]"}], " ", "-", " ", 
                RowBox[{"m", "/", "2"}]}], ")"}]}]}], "\[IndentingNewLine]", 
            ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"t2Guess", " ", "=", " ", 
         RowBox[{"tval", " ", "+", " ", 
          RowBox[{
           RowBox[{"Im", "[", "m", "]"}], "/", "2"}], " ", "+", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"tval", "<", ".3"}], ",", 
            RowBox[{"+", ".3"}], ",", " ", "0"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"t2Start", " ", "=", " ", 
         RowBox[{"t2", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tSqExact", "[", 
              RowBox[{"t1Start", " ", "+", " ", 
               RowBox[{"I", " ", "t2"}]}], "]"}], "-", 
             RowBox[{"tval", "^", "2"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t2", ",", " ", "t2Guess"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CloseToBoundary", "[", 
           RowBox[{
            RowBox[{"t1Start", "+", 
             RowBox[{"I", " ", "t2Start"}]}], ",", " ", "0"}], "]"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"betterT", "::", "outdom"}], ",", 
             RowBox[{"t1Start", "+", 
              RowBox[{"I", " ", "t2Start"}]}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"eqns", " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"tau", "[", "th", "]"}], ",", " ", "th"}], "]"}], " ", "==",
             " ", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{
               RowBox[{"DtauT", "[", 
                RowBox[{
                 RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
               "\[Conjugate]"}], "]"}], "*", 
             RowBox[{"deltbt", "[", 
              RowBox[{"tau", "[", "th", "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tau", "[", "0", "]"}], " ", "==", " ", 
            RowBox[{"t1Start", " ", "+", " ", 
             RowBox[{"I", " ", "t2Start"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"EichlerT", "[", 
                RowBox[{
                 RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
               "]"}], "<", 
              SuperscriptBox["10", 
               RowBox[{"-", "10"}]]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{
                RowBox[{"EichlerT", "[", 
                 RowBox[{
                  RowBox[{"tau", "[", "th", "]"}], ",", " ", "m"}], "]"}], 
                "+", "m"}], "]"}], "<", 
              SuperscriptBox["10", 
               RowBox[{"-", "10"}]]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"1", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"tau", "[", "th", "]"}], "-", 
                RowBox[{"3", "/", "4"}]}], "]"}], "<=", 
              RowBox[{"1", "/", "4"}]}], ",", "\"\<StopIntegration\>\""}], 
            "]"}], ",", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"tau", "[", "th", "]"}], "]"}], "<=", "0"}], ",", 
             "\"\<StopIntegration\>\""}], "]"}], ",", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"tau", "[", "th", "]"}], "]"}], ">=", "1"}], ",", 
             "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"tau", "[", "th", "]"}], "]"}], "<=", "0"}], ",", 
             "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"soln", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{"eqns", ",", " ", "tau", ",", " ", 
           RowBox[{"{", 
            RowBox[{"th", ",", " ", 
             RowBox[{"-", "thEnd"}], ",", " ", "thEnd"}], "}"}], ",", " ", 
           RowBox[{"StepMonitor", ":>", 
            RowBox[{"(", 
             RowBox[{"sMonitor", " ", "=", " ", "th"}], ")"}]}], ",", " ", 
           RowBox[{"Method", "->", "\"\<ExplicitRungeKutta\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NormalizeFunctionDomain", "[", 
         RowBox[{"(", 
          RowBox[{"tau", "/.", 
           RowBox[{"First", "@", "soln"}]}], ")"}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.92858671234806*^9, 3.928586787523728*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"3e78febb-f95e-48a9-8805-4f43e84287fb"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "LVRayx", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LVRayx", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r_", ",", " ", "d1_", ",", " ", "d2_", ",", " ", "ch2_"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"mu_", ",", " ", "m2_", ",", " ", "psi_"}], "}"}], ",", " ", 
      "t_"}], "]"}], " ", "/;", " ", 
    RowBox[{"r", "!=", "0"}]}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"d1", "+", "d2"}], 
       RowBox[{"2", "r"}]], "-", 
      FractionBox["mu", "2"]}], ")"}], "-", 
    RowBox[{"t", " ", 
     RowBox[{"Tan", "[", "psi", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sign", "[", "r", "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"DiscF0", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", ",", "d1", ",", "d2", ",", "ch2"}], "}"}], ",", " ", 
           "mu"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], "^", "2"}]], "t", 
         RowBox[{"(", 
          RowBox[{"t", "+", "m2"}], ")"}]}]}], ")"}], 
      RowBox[{"1", "/", "2"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LVRayx", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r_", ",", " ", "d1_", ",", " ", "d2_", ",", " ", "ch2_"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"mu_", ",", " ", "m2_", ",", " ", "psi_"}], "}"}], ",", " ", 
      "t_"}], "]"}], " ", "/;", " ", 
    RowBox[{"r", "==", "0"}]}], " ", ":=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"ch2", "-", 
      RowBox[{"d2", " ", "mu"}]}], 
     RowBox[{"d1", "+", "d2"}]], "-", 
    RowBox[{"t", " ", 
     RowBox[{"Tan", "[", "psi", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.941537090021997*^9, 3.941537131730852*^9}, {
  3.941537332117054*^9, 3.941537358672542*^9}, {3.9415380086451607`*^9, 
  3.941538009487577*^9}, {3.9430006291326036`*^9, 3.943000639592271*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"5eba4590-666c-496e-93c2-7dfd7b89a9ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "LVWall", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LVWall", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r_", ",", " ", "d1_", ",", " ", "d2_", ",", "ch2_"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"rr_", ",", "dd1_", ",", " ", "dd2_", ",", " ", "cch2_"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"mu_", ",", " ", "m2_", ",", " ", "psi_"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x_", ",", " ", "t_"}], "}"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "cch2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d2", " ", "m2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d1", "+", "d2", "-", 
          RowBox[{"mu", " ", "r"}]}], ")"}], " ", "t"}]}], ")"}]}], "+", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d2"}], " ", "dd1", " ", "mu"}], "+", 
       RowBox[{"d1", " ", "dd2", " ", "mu"}], "-", 
       RowBox[{"dd1", " ", "r", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{"m2", "+", "t"}], ")"}]}], "+", 
       RowBox[{"d1", " ", "rr", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{"m2", "+", "t"}], ")"}]}], "-", 
       RowBox[{"dd2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mu", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m2", "+", "t"}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{"d2", " ", "rr", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mu", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m2", "+", "t"}], ")"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
    
    RowBox[{"cch2", " ", "r", " ", 
     RowBox[{"(", 
      RowBox[{"m2", "+", 
       RowBox[{"2", " ", "t"}]}], ")"}], " ", "x"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d2", " ", "dd1", " ", "m2"}], "-", 
       RowBox[{"d1", " ", "dd2", " ", "m2"}], "-", 
       RowBox[{"2", " ", "dd2", " ", "mu", " ", "r", " ", "t"}], "+", 
       RowBox[{"2", " ", "d2", " ", "mu", " ", "rr", " ", "t"}]}], ")"}], " ",
      "x"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "dd2"}], " ", "r", " ", "t"}], "+", 
       RowBox[{"d2", " ", "rr", " ", "t"}], "-", 
       RowBox[{"dd1", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{"m2", "+", "t"}], ")"}]}], "+", 
       RowBox[{"d1", " ", "rr", " ", 
        RowBox[{"(", 
         RowBox[{"m2", "+", "t"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"ch2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dd1", " ", "t"}], "+", 
       RowBox[{"dd2", " ", 
        RowBox[{"(", 
         RowBox[{"m2", "+", "t"}], ")"}]}], "-", 
       RowBox[{"rr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mu", " ", "t"}], "+", 
          RowBox[{"m2", " ", "x"}], "+", 
          RowBox[{"2", " ", "t", " ", "x"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"m2", " ", "t", " ", 
     RowBox[{"Tan", "[", "psi", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d1"}], " ", "dd2"}], "-", 
       RowBox[{"cch2", " ", "r"}], "+", 
       RowBox[{"ch2", " ", "rr"}], "+", 
       RowBox[{"2", " ", "dd2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{"mu", "+", "x"}], ")"}]}], "+", 
       RowBox[{"d2", " ", 
        RowBox[{"(", 
         RowBox[{"dd1", "-", 
          RowBox[{"2", " ", "rr", " ", 
           RowBox[{"(", 
            RowBox[{"mu", "+", "x"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "dd2"}], " ", "r"}], "+", 
          RowBox[{"d2", " ", "rr"}]}], ")"}], " ", 
        RowBox[{"Tan", "[", "psi", "]"}]}]}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.943000644818097*^9, 3.943000647243628*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"2cbd0fc9-02d2-47c7-88d0-3c9816039431"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FPlotRay", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FPlotRay", "[", 
    RowBox[{
     RowBox[{"Rayxt", "[", 
      RowBox[{"gam_", ",", "  ", "t0_"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"mu_", ",", " ", "m2_", ",", " ", "psi_"}], "}"}], ",", " ", 
     RowBox[{"tMax_", ":", "1"}], ",", " ", 
     RowBox[{"style_", ":", " ", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
        RowBox[{"Thickness", "[", ".0014", "]"}]}], "]"}]}], ",", " ", 
     RowBox[{"label_", ":", " ", "\"\<\>\""}]}], "]"}], " ", ":=", " ", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"Tooltip", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LVRayx", "[", 
            RowBox[{
             RowBox[{"gam", "/.", "repCh"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"mu", ",", " ", "m2", ",", " ", "psi"}], "}"}], ",", 
             " ", "t"}], "]"}], ",", " ", "t"}], "}"}], ",", " ", "style"}], 
        "]"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"label", "==", "\"\<\>\""}], ",", " ", "gam", ",", " ", 
         "label"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "t0", ",", " ", "tMax"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.94155344097733*^9, 3.9415535101512938`*^9}, {
  3.941553560061516*^9, 3.941553631628396*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"3e118826-64ae-40a6-bd1a-b03d294123dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "FIntersectRays", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FIntersectRays", "[", 
   RowBox[{
    RowBox[{"Rayxt", "[", 
     RowBox[{"gam1_", ",", " ", "t01_"}], "]"}], ",", " ", 
    RowBox[{"Rayxt", "[", 
     RowBox[{"gam2_", ",", "  ", "t02_"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"mu_", ",", " ", "m2_", ",", " ", "psi_"}], "}"}], ",", " ", 
    RowBox[{"maxNum_", ":", " ", "5"}], ",", " ", 
    RowBox[{"maxt_", ":", " ", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sol", ",", " ", "kappa"}], "}"}], ",", " ", 
    RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", " ", "=", " ", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"LVRayx", "[", 
             RowBox[{"gam1", ",", " ", 
              RowBox[{"{", 
               RowBox[{"mu", ",", " ", "m2", ",", " ", "psi"}], "}"}], ",", 
              " ", "t"}], "]"}], "==", 
            RowBox[{"LVRayx", "[", 
             RowBox[{"gam2", ",", " ", 
              RowBox[{"{", 
               RowBox[{"mu", ",", " ", "m2", ",", " ", "psi"}], "}"}], ",", 
              " ", "t"}], "]"}]}], ",", " ", 
           RowBox[{"maxt", ">", "t", ">=", 
            RowBox[{"Max", "[", 
             RowBox[{"t01", ",", "t02"}], "]"}]}]}], "}"}], ",", " ", "t"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kappa", " ", "=", " ", 
       RowBox[{"Abs", "@", 
        RowBox[{"DSZ", "[", 
         RowBox[{"gam1", ",", " ", "gam2"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sol", "]"}], "==", "1"}], ",", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"kappa", " ", "n1", " ", "n2"}], " ", "-", " ", 
                RowBox[{"n1", "^", "2"}], " ", "-", " ", 
                RowBox[{"n2", "^", "2"}], " ", "+", " ", "1"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"GCD", "[", 
                RowBox[{"n1", ",", " ", "n2"}], "]"}], "==", "1"}]}], ",", 
             " ", 
             RowBox[{"Rayxt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"n1", " ", "gam1"}], "+", 
                RowBox[{"n2", " ", "gam2"}]}], ",", " ", 
               RowBox[{"t", "/.", 
                RowBox[{"First", "@", "sol"}]}]}], "]"}], ",", " ", 
             "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"n1", ",", " ", "1", ",", " ", "maxNum"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"n2", ",", " ", "1", ",", " ", "maxNum"}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.941551478651972*^9, 3.941551522959228*^9}, {
  3.9415516334516077`*^9, 3.941551731659075*^9}, {3.941551786819602*^9, 
  3.941551898538512*^9}, {3.941551951046639*^9, 3.941551973211074*^9}, {
  3.9415521223808517`*^9, 3.941552131816724*^9}, {3.9415521848672237`*^9, 
  3.941552227757556*^9}, {3.941552263577827*^9, 3.94155239804494*^9}, {
  3.9415525704667053`*^9, 3.941552577681582*^9}, {3.9415527896562843`*^9, 
  3.94155282284593*^9}, {3.9415528591463823`*^9, 3.941552860635035*^9}, {
  3.94155399562469*^9, 3.941554004739513*^9}, {3.941555028995145*^9, 
  3.941555030673102*^9}, {3.941555091955613*^9, 3.941555096691105*^9}, {
  3.941555171348813*^9, 3.941555173496364*^9}, {3.941555209363943*^9, 
  3.941555209534636*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"48cfefa7-bf56-4a72-9e38-edd011fb3b22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollOrb", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ch", "[", 
      RowBox[{"0", ",", " ", "0"}], "]"}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Ch", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", " ", "0"}], "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Ch", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ",", " ", 
     RowBox[{"Ch", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.936108294228156*^9, 3.936108314946151*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"ac2d28a3-e504-455e-8c4f-5243850a6f32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollOrbp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ch", "[", 
      RowBox[{"1", ",", " ", "0"}], "]"}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Ch", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Ch", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}]}], ",", " ", 
     RowBox[{"Ch", "[", 
      RowBox[{"0", ",", " ", "0"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9361082040120993`*^9, 3.936108234468368*^9}, {
  3.943000791145845*^9, 3.9430007937877502`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"ec0d6040-2a48-4e4e-aa00-a3e178aa3477"]
},
WindowSize->{808, 747},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a39cb34b-3030-40f5-ae28-cd9716bc62ad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 223, 7, 77, "Text",ExpressionUUID->"8aac650e-b037-4d4a-b4f0-093479733e41"],
Cell[780, 29, 497, 12, 111, "Input",ExpressionUUID->"33f15212-f082-40eb-9b84-aa303fa37690"],
Cell[1280, 43, 904, 21, 131, "Input",ExpressionUUID->"9084a06b-8c75-4e64-9bf3-045be167eec1"],
Cell[2187, 66, 561, 14, 70, "Input",ExpressionUUID->"018dca1b-eba2-4d5f-81a5-a9a69dfe4ea5"],
Cell[2751, 82, 3104, 84, 233, "Input",ExpressionUUID->"f3101aed-2cca-4c30-ae9d-94613ad262d1"],
Cell[5858, 168, 33941, 767, 2767, "Input",ExpressionUUID->"a83a0b6e-71f4-454e-b594-8e698d044fe6"],
Cell[39802, 937, 622, 16, 71, "Input",ExpressionUUID->"e4f3a887-91cd-4115-8f5a-0ab45dabf141"],
Cell[40427, 955, 29093, 615, 1876, "Input",ExpressionUUID->"bbab3940-d52e-479f-bdf0-d3812c03a782"],
Cell[69523, 1572, 32068, 688, 2030, "Input",ExpressionUUID->"89316259-3ba7-4aad-9f2b-bc200931f2b6"],
Cell[101594, 2262, 28360, 600, 1787, "Input",ExpressionUUID->"beb9eff9-7512-4eb7-9578-413413ad396b"],
Cell[129957, 2864, 29774, 637, 1880, "Input",ExpressionUUID->"8fd12ff1-2ab7-401d-8845-8fbeb648d2e7"],
Cell[159734, 3503, 3294, 74, 417, "Input",ExpressionUUID->"330bc951-048e-4938-87fa-a4eef198f839"],
Cell[163031, 3579, 760, 22, 49, "Input",ExpressionUUID->"61f5ce70-5cf5-4ebb-83f2-bfa30dc49c7b"],
Cell[163794, 3603, 2149, 60, 151, "Input",ExpressionUUID->"bd7ccd30-60e5-43f9-8fda-84d55713db33"],
Cell[165946, 3665, 3681, 95, 233, "Input",ExpressionUUID->"e34833a7-21c3-4284-833f-f385989fef89"],
Cell[169630, 3762, 562, 13, 49, "Input",ExpressionUUID->"d399bac7-c99a-467a-b892-2d8c35241369"],
Cell[170195, 3777, 489, 11, 49, "Input",ExpressionUUID->"c36af7c6-b0a5-4f51-9447-0bb9127f74f2"],
Cell[170687, 3790, 1006, 26, 90, "Input",ExpressionUUID->"f5ad42e4-3d7b-4079-b810-226569314168"],
Cell[171696, 3818, 2020, 51, 151, "Input",ExpressionUUID->"a68c295f-43f3-4368-8436-506a7d3c8936"],
Cell[173719, 3871, 4277, 103, 335, "Input",ExpressionUUID->"44cb2616-e69e-4836-95fa-04b56f15b47f"],
Cell[177999, 3976, 8894, 214, 764, "Input",ExpressionUUID->"a0681b85-baab-4495-bc35-ea99e11a588b"],
Cell[186896, 4192, 7783, 188, 697, "Input",ExpressionUUID->"270c0f34-cc55-429f-ac22-3d1d6b84bfeb"],
Cell[194682, 4382, 10604, 257, 839, "Input",ExpressionUUID->"3e78febb-f95e-48a9-8805-4f43e84287fb"],
Cell[205289, 4641, 2206, 64, 165, "Input",ExpressionUUID->"5eba4590-666c-496e-93c2-7dfd7b89a9ac"],
Cell[207498, 4707, 4105, 118, 217, "Input",ExpressionUUID->"2cbd0fc9-02d2-47c7-88d0-3c9816039431"],
Cell[211606, 4827, 1656, 43, 111, "Input",ExpressionUUID->"3e118826-64ae-40a6-bd1a-b03d294123dc"],
Cell[213265, 4872, 4024, 93, 315, "Input",ExpressionUUID->"48cfefa7-bf56-4a72-9e38-edd011fb3b22"],
Cell[217292, 4967, 689, 20, 29, "Input",ExpressionUUID->"ac2d28a3-e504-455e-8c4f-5243850a6f32"],
Cell[217984, 4989, 696, 19, 80, "Input",ExpressionUUID->"ec0d6040-2a48-4e4e-aa00-a3e178aa3477"]
}
]
*)

